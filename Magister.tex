\documentclass[14pt,a4paper]{article}

\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[footnotes,oglav,spisok,boldsect,eqwhole,kursrab,remarks,hyperprint]{project_cp}

\usepackage{hhline}
%\usepackage{slashbox}
\usepackage{multirow}
\usepackage{anyfontsize}
\usepackage{t1enc}
\usepackage{cancel}

\usepackage{extsizes}
\linespread{1.5}
\parindent=1.25cm

\usepackage{geometry}
\geometry{left=3cm, right=1cm, top=2cm, bottom=2cm}

\renewcommand{\thefigure}{\arabic{figure}}

\usepackage{comment}

\begin{document}

\thispagestyle{empty}

\begin{minipage}{0.05\textwidth}
	\hspace{-1.4cm}\vspace{0.5cm}\includegraphics[scale=0.1]{emblema}
\end{minipage}
\hfill
\begin{minipage}{0.95\textwidth}
	\centering
	\linespread{1.0}
	\fontsize{11}{14pt}\selectfont
	\textbf{Министерство образования и науки Российской Федерации \\
	Федеральное государственное бюджетное образовательное учреждение\\высшего профессионального образования\\%
	<<Московский\ государственный\ технический\ университет\\ имени\ Н.\,Э.\,Баумана\\(национальный исследовательский университет)>>\\(МГТУ им. Н.\,Э.\,Баумана)}\\[3mm]
\end{minipage}
\hrule height .7mm

\bigskip

\noindentФАКУЛЬТЕТ <<Фундаментальные науки>> \\
КАФЕДРА <<Прикладная математика>>

\bigskip

\begin{center}
	\begingroup
	\fontsize{20pt}{20pt}\selectfont
	\textbf{РАСЧЁТНО-ПОЯСНИТЕЛЬНАЯ ЗАПИСКА} \\ 
	\fontsize{16pt}{20pt}\selectfont
	\textbf{\textit{К~ВЫПУСКНОЙ~КВАЛИФИКАЦИОННОЙ~РАБОТЕ}}\\ 
	\textbf{\textit{НА ТЕМУ:}}
	
	\medskip
	\fontsize{16pt}{20pt}\selectfont \textbf{\textit{\underline{РАЗРАБОТКА МАТЕМАТИЧЕСКИХ МОДЕЛЕЙ} \underline{НЕЛОКАЛЬНОЙ УПРУГОСТИ И ИХ} \underline{ЧИСЛЕННОЕ РЕШЕНИЕ}}}
	\endgroup
\end{center}

\bigskip

\noindent
\begin{tabular}{lp{6em}cl}
	Студент группы ФН2-42М & & \hspace{3.5cm}                                & А.А. Соколов\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Руководитель ВКР      & & \hspace{3.5cm}                                & Г.Н. Кувыркин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Нормоконтролер        & & \hspace{3.5cm}                                & М.М. Лукашин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
\end{tabular}

\vspace*{\fill}

\begin{center}
	2021 г.
\end{center}



\newpage



\section-{АННОТАЦИЯ}




\newpage



\tableofcontents



\newpage



\section-{ВВЕДЕНИЕ}



\section{Основные соотношения}

\subsection{Постановка задачи}

Дано двумерное евклидово пространство $\mathbb{R}^2$ с произвольно выбранной прямоугольной декартовой системой координат $O\text{x}_1 \text{x}_2$, в которой положение точки фиксировано радиус-вектором $\boldsymbol{x} = x_i \boldsymbol{e}_i$, где $\boldsymbol{e}_i$, $i = \overline{1,2}$ --- единичные орты координатных осей; $x_i$, $i = \overline{1,2}$ --- компоненты вектора $\boldsymbol{x}$. В произвольной замкнутой области $S \subset \mathbb{R}^2$ с кусочно-гладкой границей $\partial S$ уравнение равновесия сплошной среды имеет вид \cite{MSS}
\\
\begin{gather}
	\label{EquilibriumEquation}
	\nabla_{\boldsymbol{x}} \cdot \boldsymbol{\hat{\sigma}} + \boldsymbol{b} = \boldsymbol{0},
\end{gather}
\\
где $\nabla_{\boldsymbol{x}} = \partial/\partial x_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- дифференциальный оператор набла;

$\boldsymbol{b} = b_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- вектор объёмных сил;

$\boldsymbol{\hat{\sigma}} = \sigma_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор напряжений.

Тензор напряжений $\boldsymbol{\hat{\sigma}}$ определим следующим образом
\\
\begin{gather}
	\label{DefineSigma}
	\boldsymbol{\hat{\sigma}} =
	p_1 \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} +
	p_2 \iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} dS'(\boldsymbol{x}),
\end{gather}
\\
где $\boldsymbol{\hat{C}} = C_{ijkl} \boldsymbol{e}_i \otimes \boldsymbol{e}_j \otimes \boldsymbol{e}_k \otimes \boldsymbol{e}_l$, $i, j, k, l = \overline{1, 2}$ --- тензор коэффициентов упругости; 

$\boldsymbol{\hat{\varepsilon}} = \varepsilon_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор упругой деформации; 

$p_1 > 0$ и $p_2 \geqslant 0$ --- весовые доли, такие, что $p_1 + p_2 = 1$; 

$\varphi$ --- функция нелокального влияния, некоторая нормированная положительная функция в области $S'(\boldsymbol{x})$; 

$S'(\boldsymbol{x})$ --- область нелокального влияния; 

$\boldsymbol{x'} \in S'(\boldsymbol{x})$

Будем считать, что деформации малы, поэтому для определения компонентов тензора деформации $\boldsymbol{\hat{\varepsilon}}$ воспользуемся соотношением Коши \cite{MSS}
\\
\begin{gather}
	\label{DefineStrains}
	\varepsilon_{ij} = \dfrac{1}{2} \left( u_{i, j} + u_{j, i} \right), \quad i, j = \overline{1, 2},
\end{gather}
\\
где $u_i$, $i = \overline{1, 2}$ --- компоненты вектора перемещений $\boldsymbol{u}$.

В случае линейного упругого изотропного тела для задачи в плосконапряжённой постановке компоненты тензора упругости $\boldsymbol{\hat{C}}$ определяются следующим образом
\\
\begin{gather*}
	C_{ijkl} =
	\dfrac{\nu E}{1 - \nu^2} \delta_{ij} \delta_{kl}
	+
	\dfrac{E}{2(1+\nu)} (\delta_{ik} \delta_{jl} + \delta_{il} \delta_{jk}), \quad
	i, j, k, l = \overline{1, 2},
\end{gather*}
\\
где $E$ --- модуль Юнга;

$\nu$ --- коэффициент Пуассона.

Будем рассматривать граничные условия первого и второго родов, также именуемые кинематическими и силовыми соответственно \cite{MSS}
\\
\begin{gather*}
	\boldsymbol{u}|_{\Gamma_1} = \boldsymbol{d}(\boldsymbol{x}), \quad
	\boldsymbol{\hat{\sigma}} \cdot \boldsymbol{n}|_{\Gamma_2} = \boldsymbol{p}(\boldsymbol{x}),
\end{gather*}
\\
где $\Gamma_1, \Gamma_2 \subset \partial S$ и $\Gamma_1 \cup \Gamma_2 = \emptyset$; 

$\boldsymbol{d}(\boldsymbol{x}) = d_i(\boldsymbol{x}) \boldsymbol{e}_i$ --- некоторая функция, задающая перемещение на границе $\Gamma_1$;

$\boldsymbol{p}(\boldsymbol{x}) = p_i(\boldsymbol{x}) \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- некоторая функция, задающая давление на границе  $\Gamma_2$.

\subsection{Выбор функций нелокального влияния}

В определении тензора напряжений (\ref{DefineSigma}) не конкретизируется геометрия области нелокального влияния $S'(\boldsymbol{x})$ и вид функции нелокального влияния $\varphi$. Чаще всего в расчётах используют функцию нормального распределения Гаусса, а зону нелокального влияния аппроксимируют в виде круга по правилу трёх сигм, но полученные при такой аппроксимации зоны получаются достаточно большими, что накладывает серьёзные требования на объёмы используемой оперативной памяти. Вместе с тем, вычисление экспонент является весьма затратным с вычислительной точки зрения, поэтому предлагается использовать весьма широкий класс полиномиальных функций нелокального влияния с фиксированными областями нелокального влияния $S'(\boldsymbol{x})$, которые можно представить в виде
\\
\begin{gather}
	\label{phi}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') =
	\begin{cases}
		A (1 - \rho(\boldsymbol{x}, \boldsymbol{x}')^p )^q, & \rho(\boldsymbol{x}, \boldsymbol{x}') \leqslant 1, \\ \\
		0, & \rho(\boldsymbol{x}, \boldsymbol{x}') > 1,
	\end{cases}
\end{gather}
\\
где $\rho$ --- метрическая функция, порождающая область $S'(\boldsymbol{x})$, которую в общем случае можно определить следующим образом
\\
\begin{gather*}
	\rho(\boldsymbol{x}, \boldsymbol{x}') = \sqrt[n]{
		\left| \dfrac{x_1 - x_1'}{r_1} \right|^n	+
		\left| \dfrac{x_2 - x_2'}{r_2} \right|^n
	}.
\end{gather*}
\\
Тогда нормировочный множитель $A$ примет значение
\\
\begin{gather*}
	A = \dfrac{pn}{4 r_1 r_2 \text{B}(1/n, 1/n) \text{B}(2/p, q+1)},
\end{gather*}
\\
где $r_1, r_2 > 0$ --- радиусы нелокального влияния вдоль каждой оси; 

$n > 0$ --- параметр лебегова пространства; 

$p, q > 0$ --- параметры плотности распределения нелокального влияния; 

B --- бета-функция Эйлера.

Виды области $S'(\boldsymbol{x})$ при различных параметрах лебегова пространства $n$ проиллюстрированы на рис. \ref{fig:LameEllipse}.

\begin{figure}[h!]
	\center{\includegraphics[width=0.9\textwidth]{pics/LameEllipse.eps}}
	\caption{Вид зоны нелокального влияния при $r_1 = 3$, $r_2 = 1$ и различных параметрах $n$}
	\label{fig:LameEllipse}
\end{figure}

Предполагается, что изучаемые тела изотропны, поэтому будем считать, что область нелокального влияния представляет из себя круг, то есть $r_1 = r_2 = r$, а параметр $n = 2$. Что касается параметров плотности распределения влияния, то стоит отметить, что при увеличении параметра $p$ распределение влияния становится более равномерным и стремится к константе, что в теории должно приводить к увеличению отклонения от классического закона. При увеличении параметра $q$ распределение влияния концентрируется в центре области и стремится к дельта-функции Дирака, которая при подстановке в (\ref{DefineSigma}) даст нам классический закон Гука. На рис. \ref{fig:PhiVarP} и \ref{fig:PhiVarQ} представлены примеры функций влияния в разрезе по оси симметрии при различных параметрах $p$ и $q$. Для простоты и наглядности будем считать параметры $p$ и $q$ целыми и введём обозначение $\varphi_{p,q}$, которое даст понять какие параметры были выбраны.

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/PhiVariableP.eps}}
	\caption{Портреты функций влияния при вариации $p$}
	\label{fig:PhiVarP}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/PhiVariableQ.eps}}
	\caption{Портреты функций влияния при вариации $q$}
	\label{fig:PhiVarQ}
\end{figure}

\subsection{Построение численной схемы решения на основе метода конечных элементов}

В качестве численного метода решения уравнения (\ref{EquilibriumEquation}) выберем метод конечных элементов с использованием изопараметрических конечных элементов \cite{Zienkiewicz}, \cite{Bathe}. Для этого на области $S$ введём сетку конечно-элементной модели $S_h$, которая включает в себя множества номеров узлов и элементов. Каждый элемент $(e) \in S_h$ содержит в себе наборы узлов $\left\{\boldsymbol{x}_i\right\}_{i \in I^{(e)}}$ и базисных функций $\left\{N_i^{(e)}\right\}_{i \in I^{(e)}}$ таких, что
\\
\begin{gather*}
	N_i^{(e)} \left(\boldsymbol{x}_j\right) = \delta_{ij}, \quad i,j \in I^{(e)},
	\\ \\
	\sum\limits_{i \in I^{(e)}} N_i^{(e)}(\boldsymbol{x}) = 1, \quad \forall \boldsymbol{x} \in S^{(e)},
\end{gather*}
\\
где $I^{(e)}$ --- набор индексов узлов элемента $(e)$;

$\delta_{ij}$ --- дельта-функция Кронекера;

$S^{(e)}$ --- область элемента $(e)$. 

Для каждого конечного элемента $(e)$ введём локальную систему координат $O\xi_1^{(e)}\xi_2^{(e)}$. Отображение из локальной системы координат $O\xi_1^{(e)}\xi_2^{(e)}$ в глобальную $O\text{x}_1\text{x}_2$ будем строить следующим образом
\\
\begin{gather*}
	\boldsymbol{x}\left( \boldsymbol{\xi}^{(e)} \right) =
	N_i^{(e)} \left( \boldsymbol{\xi}^{(e)} \right) \boldsymbol{x}_i, \quad
	i \in I^{(e)}, \ (e) \in S_h,
\end{gather*}
\\
где $\boldsymbol{x}_i$ --- значение глобальных координат в узлах элемента $(e)$. Тогда матрицу Якоби перехода из локальной системы координат в глобальную аппроксимируем следующим образом
\\
\begin{gather*}
	\boldsymbol{\hat{J}}^{(e)} = 
	\left( \dfrac{\partial \boldsymbol{\xi}^{(e)}}{\partial \boldsymbol{x}} \right) =
	\left( \dfrac{\partial \boldsymbol{x}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1} \approx
	\left( \boldsymbol{x}_i \dfrac{\partial N_i^{(e)}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1}, \quad
	i \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
\\

Домножим уравнение (\ref{EquilibriumEquation}) на функцию формы $N_n^{(e)}$ и проинтегрируем по области $S$
\\
\begin{gather*}
	\iint\limits_S N_n^{(e)} (\nabla_{\boldsymbol{x}} \cdot \boldsymbol{\hat{\sigma}} + \boldsymbol{b}) dS = \boldsymbol{0}, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
\\
Проинтегрируем первое слагаемое по частям, тогда по формуле Грина получим
\\
\begin{gather*}
	\iint\limits_S (\nabla_{\boldsymbol{x}} N_n^{(e)}) \cdot \boldsymbol{\hat{\sigma}} dS =
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma -
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
\\
На место $\boldsymbol{\hat{\sigma}}$ подставим соотношение (\ref{DefineSigma})
\\
\begin{multline*}
	p_1 \iint\limits_S 
	\left( \nabla_{\boldsymbol{x}} N_n^{(e)} \right)
	\cdot
	\left( \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} \right) dS
	+ \\ \\ +
	p_2 \iint\limits_S
	\left( \nabla_{\boldsymbol{x}} N_n^{(e)} \right)
	\cdot
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}}
	dS'(\boldsymbol{x})
	dS 
	= \\ \\ =
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma
	-
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{multline*}
\\
Перейдём к индексной форме записи
\\
\begin{multline*}
	p_1 \iint\limits_S N_{n, i}^{(e)} C_{ijkl} \varepsilon_{kl} dS
	+
	p_2 \iint\limits_S
	N_{n, i}^{(e)}
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') C_{ijkl} \varepsilon_{kl}
	dS'(\boldsymbol{x})
	dS 
	= \\ \\ =
	\oint\limits_{\Gamma_2} N_n^{(e)} p_j d\Gamma
	-
	\iint\limits_S N_n^{(e)} b_j dS, \quad
	i, j, k, l = \overline{1, 2}, \ n \in I^{(e)}, \ (e) \in S_h.
\end{multline*}
\\

Воспользуемся соотношением Коши (\ref{DefineStrains}) и заменим перемещения $\boldsymbol{u}$ интерполяционными соотношениями, то есть представим в виде конечной суммы $\boldsymbol{u}(\boldsymbol{x}) \approx \boldsymbol{u}_i N_i^{(e)}(\boldsymbol{x})$, $i \in I^{(e)}$, где $\boldsymbol{u}_i$ -- искомые перемещения в $i$-ом узлe. Также для простоты дальнейшего изложения, введём тензор $\boldsymbol{K}_{nm}^{(e)}$, который по сути представляет из себя блок $2 \times 2$ в $n$-ой строке и $m$-ом столбце матрицы жёсткости $\boldsymbol{\hat{K}}$. Компоненты тензора $\boldsymbol{K}_{nm}^{(e)}$ можно определить следующим образом
\\
\begin{gather*}
	K_{nmij}^{(e)(e')} (\boldsymbol{x}, \boldsymbol{y}) = 
	\delta_{np} \delta_{mq} C_{ikjl} 
	N_{n, k}^{(e)}(\boldsymbol{x}) 
	N_{m, l}^{(e')} (\boldsymbol{y}) \boldsymbol{e}_{i} \otimes \boldsymbol{e}_j \otimes \boldsymbol{E}_p \otimes \boldsymbol{E}_q,
\end{gather*}
\\
где $\boldsymbol{E}_i$ --- единичный вектор, размерность которого совпадает с количеством узлов сетки. 

Зону нелокального влияния $S'(\boldsymbol{x})$ аппроксимируем относительно каждого квадратурного узла сетки и будем считать, что элементы $(e)$, квадратурные узлы $Q^{(e)}$ которых хотя бы частично попали в область влияния, будут участвовать в расчёте. Таким образом аппроксимируем интегралы конечными суммами и наконец приходим к равенству с ассамблированной матрицей жёсткости и правой частью
\\
\begin{multline}
	\label{StiffnessMatrix1}
	\sum\limits_{(e) \in S_h} \sum\limits_{n \in I^{(e)}}
	\Biggl(
		p_1 \sum\limits_{m \in I^{(e)}}
		\sum\limits_{q \in Q^{(e)}}
		w_q \boldsymbol{K}_{nm}^{(e)(e)}(\boldsymbol{x}_q, \boldsymbol{x}_q) J_q^{(e)}
		+ \\ \\ +
		p_2 
		\sum\limits_{q \in Q^{(e)}} 
		w_q J_q^{(e)}
		\sum\limits_{(e') \in S_h'^{q}} 
		\sum\limits_{m' \in I^{(e')}} 
		\sum\limits_{q' \in Q^{(e')}}
		w_{q'} 
		\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) 
		\boldsymbol{K}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}
	\Biggr) \cdot \cdot \boldsymbol{U}
	= \\ \\ =
	\sum\limits_{(be) \in \Gamma_h}
	\sum\limits_{n \in I^{(be)}} 
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)}(\boldsymbol{x}_q) \boldsymbol{p}(\boldsymbol{x}_q) J_q^{(be)}
	- \\ \\ -
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n \in I^{(e)}}
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(e)}}
	w_q N_{n}^{(e)} (\boldsymbol{x}_q) \boldsymbol{b} (\boldsymbol{x}_q) J_q^{(e)},
\end{multline}
\\
где $\boldsymbol{U} = \boldsymbol{E}_n \otimes \boldsymbol{u}_j$ --- тензор неизвестных; $S_h'^{(q)} \subset S_h$ --- аппроксимированная зона нелокального влияния на квадратурном узле $q$; $\Gamma_h \subset S_h$ --- конечно-элементная модель границы области $S$; $(be) \in \Gamma_h$ --- одномерные элементы заданные на границе; $w_q$ --- квадратурные веса; $J_q^{(e)} = \left|\det{\boldsymbol{\hat{J}}^{(e)}(\boldsymbol{x}_q)}\right|$ --- якобиан вычисленный в квадратурной точке $\boldsymbol{x}_q$.

Вычисление системы (\ref{StiffnessMatrix1}) можно упростить записав производные от функций форм в локальной системе координат элементов
\\
\begin{gather*}
	\dfrac{\partial N_i^{(e)}}{\partial x_k} =
	\dfrac{\partial N_i^{(e)}}{\partial \xi_j^{(e)}}
	\dfrac{\partial \xi_j^{(e)}}{\partial x_k}, \quad
	j, k = \overline{1, 2}, \ i \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
\\

Якобиан на границе аппроксимируем следующим образом
\\
\begin{gather*}
	J^{(be)} = \sqrt{
	\left( x_{1i} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2 +
	\left( x_{2i} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2	
	}, \quad
	i \in I^{(be)}, \ (be) \in \Gamma_h.
\end{gather*}
\\
Заметим, что индекс оси $\xi^{(e)}$ не ставится, так как элемент одномерный.




\section{Программная реализация}

\subsection{Аппроксимация зоны нелокального влияния}

Основной сложностью, которая возникает при решении задачи (\ref{EquilibriumEquation}), является аппроксимация интегрального слагаемого в (\ref{DefineSigma}), так как в матрицах элементов необходимо учитывать влияние, которое приходится на соседние элементы. Действуя по правилам аппроксимации вложенных интегралов мы приходим к тому, что в уравнении (\ref{StiffnessMatrix1}) порядок сумм заставляет нас аппроксимировать зону нелокального влияния для каждого квадратурного узла сетки, что не очень практично, так как выполнять поиск ближайших соседей относительно квадратурных узлов может быть весьма затратной процедурой, а хранении индексов элементов, которые попадают в зону влияния, очень дорогим. Более того, такой подход попросту сложно реализовать программно, поэтому предлагается аппроксимировать зону нелокального влияния относительно центров элементов и учитывать в расчётах те элементы, центры которых попали в зону влияния. Тогда формулу (\ref{StiffnessMatrix1}) можно переписать в следующем виде
\\
\begin{multline}
	\label{StiffnessMatrix2}
	\sum\limits_{(e) \in S_h} \sum\limits_{n \in I^{(e)}}
	\Biggl(
		p_1 \sum\limits_{m \in I^{(e)}}
		\sum\limits_{q \in Q^{(e)}}
		w_q \boldsymbol{K}_{nm}^{(e)(e)}(\boldsymbol{x}_q, \boldsymbol{x}_q) J_q^{(e)}
		+ \\ \\ +
		p_2
		\sum\limits_{(e') \in S_h'^{q}} 
		\sum\limits_{m' \in I^{(e')}}
		\sum\limits_{q \in Q^{(e)}} 
		w_q J_q^{(e)}  
		\sum\limits_{q' \in Q^{(e')}}
		w_{q'} 
		\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) 
		\boldsymbol{K}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}
	\Biggr) \cdot \cdot \boldsymbol{U}
	= \\ \\ =
	\sum\limits_{(be) \in \Gamma_h}
	\sum\limits_{n \in I^{(be)}} 
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)}(\boldsymbol{x}_q) \boldsymbol{p}(\boldsymbol{x}_q) J_q^{(be)}
	- \\ \\ -
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n \in I^{(e)}}
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(e)}}
	w_q N_{n}^{(e)} (\boldsymbol{x}_q) \boldsymbol{b} (\boldsymbol{x}_q) J_q^{(e)},
\end{multline}
\\
где $S_h'^{(e)}$ --- зона нелокального влияния аппроксимированная на элементе.

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/ApproxS.eps}}
	\caption{Аппроксимация зоны нелокального влияния}
	\label{fig:ApproxS}
\end{figure}

Заметим, что в формуле (\ref{StiffnessMatrix2}) поменялся порядок знаков суммирования, а значит и порядок действий. С точки зрения написания вычислительной программы это означает лишь перестановку циклов и введение дополнительных массивов индексов. Для успешного интегрирования, зону аппроксимации лучше всего брать несколько больше, нежели реальная зона нелокального влияния, таким образом возникает шанс того, что все квадратурные узлы, которые попали под зону влияния $S'(\boldsymbol{x})$ будут учтены в расчёте. Естественно, радиус поиска следует определять исходя из грубости сетки, что наглядно продемонстрировано на рис. \ref{fig:ApproxS}.

\subsection{Распараллеливание алгоритма}

Учитывая высокую вычислительную сложность подобных задач разумно использовать возможности современных вычислительных систем, а именно параллельные и распределённые вычисления. К сожалению, обход сетки, который задаётся порядком суммирования в (\ref{StiffnessMatrix2}) не позволяет эффективно использовать такие возможности, поэтому возникает предложение определить другой порядок обхода сетки, в котором не будет проблем связанных с гонкой данных и который позволит собирать части матрицы независимо сразу в нескольких процессах. Этого можно достичь определив для каждого узла сетки множество элементов $E^{(n)}$, которым он принадлежит. Такой подход позволяет эффективно использовать возможности параллельных и распределённых систем, так как каждая строка матрицы вычисляется независимо от всех остальных. Заметим, что порядок суммирования при аппроксимации граничных условий второго рода менять не обязательно, так как данная операция не является трудозатратной и поэтому её проще всего реализовать согласно классическому представлению. Таким образом, формула (\ref{StiffnessMatrix2}) принимает вид
\\
\begin{multline}
	\label{StiffnessMatrix3}
	\sum\limits_{n \in S_h} \sum\limits_{(e) \in E^{(n)}}
	\Biggl(
		p_1 \sum\limits_{m \in I^{(e)}}
		\sum\limits_{q \in Q^{(e)}}
		w_q \boldsymbol{K}_{nm}^{(e)(e)}(\boldsymbol{x}_q, \boldsymbol{x}_q) J_q^{(e)}
		+ \\ \\ +
		p_2
		\sum\limits_{(e') \in S_h'^{q}} 
		\sum\limits_{m' \in I^{(e')}}
		\sum\limits_{q \in Q^{(e)}} 
		w_q J_q^{(e)}  
		\sum\limits_{q' \in Q^{(e')}}
		w_{q'} 
		\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) 
		\boldsymbol{K}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}
	\Biggr) \cdot \cdot \boldsymbol{U}
	= \\ \\ =
	\sum\limits_{(be) \in \Gamma_h}
	\sum\limits_{n \in I^{(be)}} 
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)}(\boldsymbol{x}_q) \boldsymbol{p}(\boldsymbol{x}_q) J_q^{(be)}
	- \\ \\ -
	\sum\limits_{n \in S_h}
	\boldsymbol{E}_n \otimes
	\sum\limits_{(e) \in E^{(n)}}
	\sum\limits_{q \in Q^{(e)}}
	w_q N_{n}^{(e)} (\boldsymbol{x}_q) \boldsymbol{b} (\boldsymbol{x}_q) J_q^{(e)},
\end{multline}
\\

\subsection{Балансировка данных}

Как уже было сказано, поузловой обход сетки (\ref{StiffnessMatrix3}) позволяет достаточно эффективно использовать параллельные и распределённые вычисления. Однако при распределённых вычислениях возникает проблема балансировки данных между процессами, так как если раздать обработку узлов сетки между процессами равномерно, то данные могут иметь произвольное распределение, что может привести к слишком высоким затратам вычислительных ресурсов на некоторых узлах кластера, в то время как остальным придётся проводить время в ожидании. Такой дисбаланс также может привести к тому, что на некоторых узлах кластера может не хватить оперативной памяти, хотя потенциально такая задача могла бы поместиться при равномерном распределении данных. В таком случае необходимо делать балансировку данных между процессами.

Идеальная балансировка подразумевает распределение данных таким образом, чтобы потребляемые объёмы оперативной памяти и объёмы вычислений на всех процессах были одинаковыми, но практика показывает, что добиться такой балансировки в общем случае не удаётся, поэтому опишем два возможных варианта балансировки.

Первый вариант позволяет добиться равномерного распределения объёмов потребляемой оперативной памяти между процессами $P$. Этот вариант балансировки подразумевает под собой осреднение количества элементов матрицы между процессами $p \in P$. Чтобы этого добиться, необходимо подсчитать количество элементов матрицы $M_p$, которым владеет каждый из процессов. Затем сложить все эти суммы $M = \sum\limits_{p \in P} M_p$ и взять среднее по количеству процессов $M_m = M/|P|$. После этого распределить узлы таким образом, чтобы количество элементов матрицы на каждом из процессов $\widetilde{M}_p$ было примерно одинаковым, то есть $\widetilde{M}_p \approx M_m$. Для подсчёта количества элементов в матрице не требуется формировать полный портрет матрицы на каждом из процессов, это можно делать построчно, что гораздо эффективнее и не приводит к высоким затратам оперативной памяти.

Второй вариант балансировки позволяет добиться равномерного распределения объёмов вычислений. Такой вариант балансировки достигается аналогичными методами, но в качестве осредняемого параметра выбирается количество вызовов функции интегрирования.

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarFx205.eps}}
	\caption{}
	\label{fig:LongRectStress11VarFx205}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarFx200.eps}}
	\caption{}
	\label{fig:LongRectStress11VarFx200}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarR.eps}}
	\caption{}
	\label{fig:LongRectStress11VarR}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarP.eps}}
	\caption{}
	\label{fig:LongRectStress11VarP}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectSigma12X1.eps}}
	\caption{}
	\label{fig:LongRectSigma12X1}
\end{figure}

\begin{figure}
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectSigma12X2.eps}}
	\caption{}
	\label{fig:LongRectSigma12X2}
\end{figure}




\begin{table}
	\begin{tabular}{|c|c|c|c|c|c|c|}
		\hline
		$N$   & $r$  & $M$  & $V$     & $t_1$, с & $t_{16}$, с & $t_1 / t_{16}$ \\
		\hline
		2500  & 0    & ---  & 3 Мб    & 0.065    & 0.019       & 3.421 \\
		\hline
		10000 & 0    & ---  & 12 Мб   & 0.296    & 0.065       & 4.554 \\
		\hline
		40000 & 0    & ---  & 46 Мб   & 1.490    & 0.277       & 5.379 \\
		\hline
		2500  & 0.05 & 20   & 19 Мб   & 3.583    & 0.321       & 11.16 \\
		\hline
		10000 & 0.05 & 69   & 203 Мб  & 48.82    & 3.773       & 12.93 \\
		\hline
		40000 & 0.05 & 295  & 2.9 Гб  & 815.5    & 60.45       & 13.49 \\
		\hline
		2500  & 0.1  & 66   & 48 Мб   & 11.45    & 0.854       & 13.41 \\
		\hline
		10000 & 0.1  & 281  & 687 Мб  & 193.3    & 13.90       & 13.91 \\
		\hline
		40000 & 0.1  & 1143 & 10.2 Гб & 3161     & 222.5       & 14.21 \\
		\hline
	\end{tabular} \\
	\caption{Сравнение последовательного и параллельного режимов работы}
\end{table}

\begin{table}
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
	\hline
	$N$   & $r$  & $V_1$  & $t_{16}^1$, с & $V_2$  & $t_{16}^2$, с & $V_3$  & $t_{16}^3$, с & $V_4$  & $t_{16}^4$, с \\
	\hline
	10000 & 0.05 & 42 Мб  & 0.934         & 40 Мб  & 0.868         & 39 Мб  & 0.890         & 82 Мб  & 0.974 \\
	\hline
	10000 & 0.1  & 136 Мб & 3.775         & 130 Мб & 3.396         & 130 Мб & 3.670         & 291 Мб & 3.775 \\
	\hline
	40000 & 0.05 & 558 Мб & 15.16         & 545 Мб & 14.19         & 544 Мб & 14.55         & 1.2 Гб & 15.74 \\
	\hline
	40000 & 0.1  & 1.9 Гб & 55.41         & 1.9 Гб & 54.80         & 1.9 Гб & 57.47         & 4.5 Гб & 59.91 \\
	\hline
	\end{tabular} \\
	\caption{Распределение объёмов данных и времени выполнения между процессами при балансировке объёмов вычислений}
\end{table}

\begin{table}
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
	\hline
	$N$   & $r$ & $V_1$   & $t_{16}^1$, с & $V_2$  & $t_{16}^2$, с & $V_3$  & $t_{16}^3$, с & $V_4$  & $t_{16}^4$, с \\
	\hline
	10000 & 0.05 & 50 Мб  & 1.133         & 51 Мб  & 1.119         & 51 Мб  & 0.917         & 51 Мб  & 0.603 \\
	\hline
	10000 & 0.1  & 168 Мб & 4.545         & 172 Мб & 4.505         & 175 Мб & 3.212         & 172 Мб & 2.236 \\
	\hline
	40000 & 0.05 & 711 Мб & 19.12         & 716 Мб & 18.68         & 723 Мб & 12.40         & 716 Мб & 9.311 \\
	\hline
	40000 & 0.1  & 2.5 Гб & 72.66         & 2.6 Гб & 72.46         & 2.5 Гб & 45.91         & 2.6 Гб & 34.72 \\
	\hline
	\end{tabular} \\
	\caption{Распределение объёмов данных и времени выполнения между процессами при балансировке количества элементов матрицы}
\end{table}



\newpage



\begin{thebibliography}{1}
	\bibitem{MSS} Зарубин В.С., Кувыркин Г.Н. Математические модели механики и электродинамики сплошной среды. М.: Изд-во МГТУ им. Н.Э. Баумана, 2008. 512 с.
	
	\bibitem{Zienkiewicz} Zienkiewicz O. The Finite Element Method: Its Basis and Fundamentals. Seventh edition. / O. Zienkiewicz, R. Taylor, J.Z. Zhu -- 2013. -- 756 p.

	\bibitem{Bathe} Bathe K-J. Finite Element Procedures. Second edition. --- 2014. --- 1065 p.
\end{thebibliography}

\end{document}