\documentclass[14pt,a4paper]{article}

\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[footnotes,oglav,spisok,boldsect,eqwhole,kursrab,remarks,hyperprint]{project}

\usepackage{hhline}
\usepackage{multirow}
\usepackage{anyfontsize}
\usepackage{t1enc}
\usepackage{cancel}

\usepackage{float}

\usepackage{extsizes}
\linespread{1.5}
\parindent=1.25cm

\usepackage{geometry}
\geometry{left=3cm, right=1cm, top=2cm, bottom=2cm}

\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thetable}{\arabic{table}}  

\usepackage{comment}

\usepackage{subcaption}
\renewcommand\thesubfigure{\asbuk{subfigure}}

\expandafter\def\expandafter\normalsize\expandafter{%
    \normalsize
    \setlength\abovedisplayskip{5ex}
    \setlength\belowdisplayskip{5ex}
    \setlength\abovedisplayshortskip{5ex}
    \setlength\belowdisplayshortskip{5ex}
}

\begin{document}

\thispagestyle{empty}

\begin{minipage}{0.05\textwidth}
	\hspace{-1.4cm}\vspace{0.5cm}\includegraphics[scale=0.1]{emblema}
\end{minipage}
\hfill
\begin{minipage}{0.95\textwidth}
	\centering
	\linespread{1.0}
	\fontsize{11}{14pt}\selectfont
	\textbf{Министерство образования и науки Российской Федерации \\
	Федеральное государственное бюджетное образовательное учреждение\\высшего профессионального образования\\%
	<<Московский\ государственный\ технический\ университет\\ имени\ Н.\,Э.\,Баумана\\(национальный исследовательский университет)>>\\(МГТУ им. Н.\,Э.\,Баумана)}\\[3mm]
\end{minipage}
\hrule height .7mm

\bigskip

\noindentФАКУЛЬТЕТ <<Фундаментальные науки>> \\
КАФЕДРА <<Прикладная математика>>

\bigskip

\begin{center}
	\begingroup
	\fontsize{20pt}{20pt}\selectfont
	\textbf{РАСЧЁТНО-ПОЯСНИТЕЛЬНАЯ ЗАПИСКА} \\ 
	\fontsize{16pt}{20pt}\selectfont
	\textbf{\textit{К~ВЫПУСКНОЙ~КВАЛИФИКАЦИОННОЙ~РАБОТЕ}}\\ 
	\textbf{\textit{НА ТЕМУ:}}
	
	\medskip
	%Разработка математических моделей теории нелокальной упругости и их численное исследование и анализ.
	\fontsize{16pt}{20pt}\selectfont 
	\textbf{\textit{
		\underline{РАЗРАБОТКА МАТЕМАТИЧЕСКИХ МОДЕЛЕЙ}
		\underline{ТЕОРИИ НЕЛОКАЛЬНОЙ УПРУГОСТИ И ИХ} 
		\underline{ЧИСЛЕННОЕ ИССЛЕДОВАНИЕ И АНАЛИЗ}
	}}
	\endgroup
\end{center}

\bigskip

\noindent
\begin{tabular}{lp{6em}cl}
	Студент группы ФН2-42М & & \hspace{3.5cm}                                & А.А. Соколов\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Руководитель ВКР      & & \hspace{3.5cm}                                & Г.Н. Кувыркин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Нормоконтролер        & & \hspace{3.5cm}                                & М.М. Лукашин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
\end{tabular}

\vspace*{\fill}

\begin{center}
	2021 г.
\end{center}



\newpage



\section-{АННОТАЦИЯ}

Расчётно-пояснительная записка 58 с., 47 рис., 4 табл., 23 источника.

В качестве объекта исследования в работе выступает двумерное уравнение равновесия в нелокальной постановке. В качестве численного метода решения был выбран метод конечных элементов с использованием изопараметрических конечных элементов.

Цель работы --- реализация эффективного конечно-элементного решателя уравнений равновесия в нелокальной постановке с граничными условиями первого и второго родов, анализ полученных результатов и сравнение их с решением аналогичных уравнений в классической постановке.

В работе изложена постановка задачи и описан параллельный и распределённый алгоритм сборки матрицы жёсткости с использованием технологий OpenMP и MPI. Также были предложены различные варианты балансировки данных между процессами. Проанализирована эффективность и масштабируемость полученного алгоритма на примере результатов расчётов на гибридном вычислительном кластере К-10. В работе описаны особенности связанные с выполнением принципа Сен-Венана на примере вытянутой прямоугольной пластины. Проведено исследование поведения решений в областях со ступенчатыми переходами, а также в областях с эллиптическими вырезами. Полученные результаты были сравнены с результатами решения уравнения в классической постановке. Результаты для областей со ступенчатыми переходами также были сравнены с результатами экспериментов. Для областей с эллиптическими вырезами была проанализирована зависимость максимальных напряжений от соотношения полуосей эллипсов.



\newpage



\tableofcontents



\newpage



\section-{ВВЕДЕНИЕ}

Современное машиностроение ставит высокие требования к физико-механическим свойствам материалов из которых должны быть изготовлены детали конструкций или их покрытия. Как правило, такими материалами становятся различные структурно-чувствительные материалы, которые получают при помощи компактирования нанопорошков, осаждением на подложку, кристализацией аморфных сплавов и другими способами \cite{Nanomaterial}.

Использование классических математических моделей для структурно-чувствительных материалов некорректно, так как классические модели не учитывают масштабных эффектов, которые в телах малых размеров становятся сопоставимыми с размерами самого тела и начинают оказывать существенное влияние. Существует множество различных моделей, которые описывают подобные эффекты, однако наибольший интерес представляют модели, в которых основные соотношения имеют ту же формулировку, что и классические. Одной из таких моделей является нелокальной модель Эрингена \cite{Eringen}, где определяющие соотношения имеют тот же вид, что и в классическом подходе, но представлены в интегро-дифференциальном форме. Такая формулировка открывает возможности для использования хорошо изученных численных методов, в частности метода конечных элементов.

В данной работе рассмотрено решение двумерного уравнения равновесия в нелокальной постановке. Ранее, подобные уравнения в двумерных постановка были рассмотрены в работах \cite{Pisano}, \cite{Wen}, \cite{Abdollahi} и многих других. Основной сложностью, с которой сталкиваются исследователи при решении подобных задач, это аппроксимация интегро-дифференциальных уравнений. В частности, в методе конечных элементов, который применительно к данным задачам принято ещё называть методом нелокальных конечных элементов, приходится выполнять поиск ближайших соседей, что приводит к некоторым дополнительным расходам при расчётах и усложняет структуру вычислительной программы.

Стоит отметить, что схемы решения такого рода уравнений отличаются высокой вычислительной сложностью, так как итоговые СЛАУ имеют высокую плотность заполненности и эта плотность стремится к константе при дроблении сетки. То есть, даже несмотря на использование разреженных и симметрических матриц, не всегда удаётся достичь существенной экономии ресурсов. Прямые методы решения такого рода СЛАУ сталкиваются с проблемами нехватки оперативной памяти, а итерационные имеют медленную сходимость в виду большого количества ненулевых элементов в матрице. Однако скорость сходимости итерационных методов можно ускорить если воспользоваться альтернативными базисами конечных элементов \cite{QuadSerendipity}, \cite{QubicSerendipity}, подробности исследования которых описаны в приложении А. Вместе с колоссальными объёмами требуемой оперативной памяти также существует проблема большого объёма вычислений, которая частично решается современными параллельными и распределёнными вычислительными системами.

Особым интересом исследования является проверка классических принципов и гипотез. В частности, одним из таких принципов является принцип Сен-Венана \cite{MSS}, проверка которого представлена в разделе с результатами рассчётов. Также особый интерес представляют области с концентраторами, так как они являются типичными проблемами механики разрушения из-за сингулярных деформаций и напряжений, которые в них возникают. В работе пойдёт речь об областях со ступенчатыми переходами и эллиптическими вырезами, так как они имеют достаточно простую структуру, а также различные теоретические и экспериментальные оценки и результаты.



\newpage



\section{Основные соотношения}

\subsection{Постановка задачи}

Дано двумерное евклидово пространство $\mathbb{R}^2$ с произвольно выбранной прямоугольной декартовой системой координат $O\text{x}_1 \text{x}_2$, в которой положение точки фиксировано радиус-вектором $\boldsymbol{x} = x_i \boldsymbol{e}_i$, где $\boldsymbol{e}_i$, $i = \overline{1,2}$ --- единичные орты координатных осей; $x_i$, $i = \overline{1,2}$ --- компоненты вектора $\boldsymbol{x}$. В произвольной замкнутой области $S \subset \mathbb{R}^2$ с кусочно-гладкой границей $\partial S$ уравнение равновесия сплошной среды имеет вид \cite{MSS}
\begin{gather}
	\label{EquilibriumEquation}
	\nabla \cdot \boldsymbol{\widehat{\sigma}} + \boldsymbol{b} = \boldsymbol{0},
\end{gather}
где $\nabla = \partial/\partial x_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- дифференциальный оператор набла;

$\boldsymbol{b} = b_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- вектор плотности объёмных сил;

$\boldsymbol{\widehat{\sigma}} = \sigma_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор напряжений.

Тензор напряжений $\boldsymbol{\widehat{\sigma}}$ определим следующим образом
\begin{gather}
	\label{DefineSigma}
	\boldsymbol{\widehat{\sigma}} =
	p_1 \widehat{\text{\textbf{C}}} \cdot \cdot \boldsymbol{\widehat{\varepsilon}} +
	p_2 \iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \widehat{\text{\textbf{C}}} \cdot \cdot \boldsymbol{\widehat{\varepsilon}} dS'(\boldsymbol{x}),
	\quad
	\boldsymbol{x'} \in S'(\boldsymbol{x}),
\end{gather}
где $\widehat{\text{\textbf{C}}} = C_{ijkl} \boldsymbol{e}_i \otimes \boldsymbol{e}_j \otimes \boldsymbol{e}_k \otimes \boldsymbol{e}_l$, $i, j, k, l = \overline{1, 2}$ --- тензор коэффициентов упругости; 

$\boldsymbol{\widehat{\varepsilon}} = \varepsilon_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор деформации; 

$p_1 > 0$ и $p_2 \geqslant 0$ --- весовые доли классического и нелокального законов, соответственно, такие, что $p_1 + p_2 = 1$; 

$\varphi$ --- функция нелокального влияния, некоторая нормированная положительная функция в области $S'(\boldsymbol{x})$; 

$S'(\boldsymbol{x})$ --- область нелокального влияния.

Положим, что деформации малы, поэтому для определения компонент тензора деформации $\boldsymbol{\widehat{\varepsilon}}$ воспользуемся соотношением Коши \cite{MSS}
\begin{gather}
	\label{DefineStrains}
	\varepsilon_{ij} = \dfrac{1}{2} \left( u_{i, j} + u_{j, i} \right), \quad i, j = \overline{1, 2},
\end{gather}
где $u_i$, $i = \overline{1, 2}$ --- компоненты вектора перемещения $\boldsymbol{u}$.

В случае линейного упругого изотропного тела для задачи в плоском напряжённом состоянии компоненты тензора упругости $\widehat{\text{\textbf{C}}}$ определяют следующим образом:
\begin{gather*}
	C_{ijkl} =
	\dfrac{\nu E}{1 - \nu^2} \delta_{ij} \delta_{kl}
	+
	\dfrac{E}{2(1+\nu)} (\delta_{ik} \delta_{jl} + \delta_{il} \delta_{jk}), \quad
	i, j, k, l = \overline{1, 2},
\end{gather*}
где $E$ --- модуль Юнга;

$\nu$ --- коэффициент Пуассона.

Будем рассматривать граничные условия первого и второго родов, также именуемые кинематическими и силовыми, соответственно \cite{MSS},
\begin{gather*}
	\boldsymbol{u}|_{\Gamma_1} = \boldsymbol{d}(\boldsymbol{x}), \quad
	\boldsymbol{\widehat{\sigma}} \cdot \boldsymbol{n}|_{\Gamma_2} = \boldsymbol{p}(\boldsymbol{x}),
\end{gather*}
где $\Gamma_1, \Gamma_2 \subset \partial S$ и $\Gamma_1 \cup \Gamma_2 = \emptyset$; 

$\boldsymbol{d}(\boldsymbol{x}) = d_i(\boldsymbol{x}) \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- некоторая функция, задающая перемещения на границе~$\Gamma_1$;

$\boldsymbol{p}(\boldsymbol{x}) = p_i(\boldsymbol{x}) \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- некоторая функция, задающая вектор плотности поверхностной нагрузки на границе  $\Gamma_2$;

$\boldsymbol{n}$ --- внешняя нормаль области $S$.

\subsection{Выбор функций нелокального влияния}

В определении тензора напряжений (\ref{DefineSigma}) не конкретизирована геометрия области нелокального влияния $S'(\boldsymbol{x})$ и вид функции нелокального влияния $\varphi$. Чаще всего в расчётах используют функцию нормального распределения Гаусса, а зону нелокального влияния аппроксимируют в виде круга по правилу трёх сигм, но полученные при такой аппроксимации зоны получаются достаточно большими, что приводит к большим затратам используемой оперативной памяти. Вместе с тем, вычисление экспонент является весьма трудоёмкой процедурой, поэтому возникает предложение использовать весьма широкий класс полиномиальных функций нелокального влияния с фиксированными областями этого влияния $S'(\boldsymbol{x})$, которые можно представить в виде
\begin{gather}
	\label{phi}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') =
	\begin{cases}
		A (1 - \rho(\boldsymbol{x}, \boldsymbol{x}')^p )^q, & \rho(\boldsymbol{x}, \boldsymbol{x}') \leqslant 1, \\ \\
		0, & \rho(\boldsymbol{x}, \boldsymbol{x}') > 1,
	\end{cases}
\end{gather}
где $\rho$ --- метрическая функция, порождающая область $S'(\boldsymbol{x})$, которую в общем случае можно определить следующим образом
\begin{gather*}
	\rho(\boldsymbol{x}, \boldsymbol{x}') = \sqrt[n]{
		\left| \dfrac{x_1 - x_1'}{r_1} \right|^n	+
		\left| \dfrac{x_2 - x_2'}{r_2} \right|^n
	}.
\end{gather*}
Тогда нормировочный множитель $A$ примет значение
\begin{gather*}
	A = \dfrac{pn}{4 r_1 r_2 \text{B}(1/n, 1/n) \text{B}(2/p, q+1)},
\end{gather*}
где $r_1, r_2 > 0$ --- длины полуосей области $S'(\boldsymbol{x})$; 

$n > 0$ --- параметр; 

$p, q > 0$ --- параметры плотности распределения нелокального влияния; 

$\text{B}(x, y) = \int\limits_0^1 t^{x-1} (1-t)^{y-1} dt$ --- бета-функция Эйлера \cite{SpecFunc}.

Форма зоны нелокального влияния $S'(\boldsymbol{x})$, при различных параметрах $n$ и фиксированных длинах полуосей $r_1$ и $r_2$, проиллюстрированы на рис. \ref{fig:LameEllipse}.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.9\textwidth]{pics/LameEllipse.eps}
	\caption{Формы зоны нелокального влияния при различных параметрах $n$ и радиусах $r_1 = 3$, $r_2 = 1$}
	\label{fig:LameEllipse}
\end{figure}

Предположим, что рассматриваемые материалы изотропны, поэтому будем полагать, что область нелокального влияния является кругом, то есть $r_1 = r_2 = r$, а параметр $n = 2$. Далее в работе мы будем варьировать параметры плотности распределения влияния $p$ и $q$. Будем считать, что эти параметры целые, поэтому, для простоты изложения, суженный класс функций нелокального влияния будем обозначить как $\varphi_{p, q}$. На рис. \ref{fig:PhiVarP} и \ref{fig:PhiVarQ} представлены примеры функций нелокального влияния в разрезе по оси симметрии при различных параметрах $p$ и $q$. На рисунках видно, что при увеличении параметра $p$, распределение влияния становится равномернее и стремится к константе $(\pi r^2)^{-1}$, что в теории должно приводить к увеличению отклонения решения нелокальной задачи от аналогичного решения классической. При увеличении параметра $q$ распределение концентрируется в центре области и стремится к дельта-функции Дирака \cite{Meiz}, которая, при постановке в (\ref{DefineSigma}), даст нам классический закон Гука. Смешанное варьирование параметро $p$ и $q$ рассматривать не будем.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{pics/PhiVariableP.eps}
	\caption{Портреты функций влияния при вариации $p$}
	\label{fig:PhiVarP}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{pics/PhiVariableQ.eps}
	\caption{Портреты функций влияния при вариации $q$}
	\label{fig:PhiVarQ}
\end{figure}

Для практических расчётов следует использовать функции с наименьшими вычислительными затратами, но в то же время обеспечивающими уменьшение влияния на расстоянии. В классе полиномиальных функций это функция $\varphi_{2,1}$, которую мы будем использовать во всех расчётах, если не сказано~иного.

\subsection{Построение численной схемы решения на основе метода конечных элементов}

В качестве численного метода решения уравнения (\ref{EquilibriumEquation}) выберем метод конечных элементов с использованием изопараметрических конечных элементов \cite{Zienkiewicz}, \cite{Bathe}. Для этого на области $S$ введём сетку конечно-элементной модели $S_h$, которая включает в себя множества номеров узлов и элементов. Каждый элемент $(e) \in S_h$ содержит в себе наборы узлов $\left\{\boldsymbol{x}_i\right\}_{i \in I^{(e)}}$ и базисных функций $\left\{N_i^{(e)}\right\}_{i \in I^{(e)}}$ таких, что
\begin{gather*}
	N_i^{(e)} \left(\boldsymbol{x}_j\right) = \delta_{ij}, \quad i,j \in I^{(e)},
	\\ \\
	\sum\limits_{i \in I^{(e)}} N_i^{(e)}(\boldsymbol{x}) = 1, \quad \forall \boldsymbol{x} \in S^{(e)},
\end{gather*}
где $I^{(e)}$ --- набор индексов узлов элемента $(e)$;

$\delta_{ij}$ --- дельта-функция Кронекера \cite{Meiz};

$S^{(e)}$ --- область элемента $(e)$. 

Для каждого конечного элемента $(e)$ введём локальную систему координат $O\xi_1^{(e)}\xi_2^{(e)}$. Отображение из локальной системы координат $O\xi_1^{(e)}\xi_2^{(e)}$ в глобальную $O\text{x}_1\text{x}_2$ будем строить следующим образом:
\begin{gather*}
	\boldsymbol{x}\left( \boldsymbol{\xi}^{(e)} \right) =
	N_i^{(e)} \left( \boldsymbol{\xi}^{(e)} \right) \boldsymbol{x}_i, \quad
	i \in I^{(e)}, \ (e) \in S_h,
\end{gather*}
где $\boldsymbol{x}_i$ --- значение глобальных координат в узлах сетки. Тогда матрицу Якоби перехода из локальной системы координат в глобальную аппроксимируем следующим образом
\begin{gather*}
	\widehat{\text{\textbf{J}}}^{(e)} = 
	\left( \dfrac{\partial \boldsymbol{\xi}^{(e)}}{\partial \boldsymbol{x}} \right) =
	\left( \dfrac{\partial \boldsymbol{x}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1} \approx
	\left( \boldsymbol{x}_i \dfrac{\partial N_i^{(e)}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1}, \quad
	i \in I^{(e)}, \ (e) \in S_h.
\end{gather*}

Домножим уравнение (\ref{EquilibriumEquation}) на функцию формы $N_n^{(e)}$ и проинтегрируем по области $S$
\begin{gather*}
	\iint\limits_S N_n^{(e)} (\nabla \cdot \boldsymbol{\widehat{\sigma}} + \boldsymbol{b}) dS = \boldsymbol{0}, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
Проинтегрируем первое слагаемое по частям, тогда по формуле Грина приходим к уравнению вида
\begin{gather*}
	\iint\limits_S (\nabla N_n^{(e)}) \cdot \boldsymbol{\widehat{\sigma}} dS =
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma -
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
На место $\boldsymbol{\widehat{\sigma}}$ подставим соотношение (\ref{DefineSigma})
\begin{multline*}
	p_1 \iint\limits_S 
	\left( \nabla N_n^{(e)} \right)
	\cdot
	\left( \widehat{\text{\textbf{C}}} \cdot \cdot \boldsymbol{\widehat{\varepsilon}} \right) dS
	+ \\ \\ +
	p_2 \iint\limits_S
	\left( \nabla N_n^{(e)} \right)
	\cdot
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \widehat{\text{\textbf{C}}} \cdot \cdot \boldsymbol{\widehat{\varepsilon}}
	dS'(\boldsymbol{x})
	dS 
	= \\ \\ =
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma
	-
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{multline*}
Перейдём к индексной форме записи
\begin{gather*}
	p_1 \iint\limits_S N_{n, i}^{(e)} C_{ijkl} \varepsilon_{kl} dS
	+
	p_2 \iint\limits_S
	N_{n, i}^{(e)}
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') C_{ijkl} \varepsilon_{kl}
	dS'(\boldsymbol{x})
	dS 
	= \\ \\
	 =
	\oint\limits_{\Gamma_2} N_n^{(e)} p_j d\Gamma
	-
	\iint\limits_S N_n^{(e)} b_j dS, \quad
	i, j, k, l = \overline{1, 2}, \ n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}

Итоговое выражение, которое мы хотим получить можно записать в следующем виде
\begin{gather*}
	\left( p_1 \widehat{\text{\textbf{K}}}^{Loc} + p_2 \widehat{\text{\textbf{K}}}^{NonLoc} \right) \cdot \cdot \widehat{\text{\textbf{U}}} = \widehat{\text{\textbf{P}}} - \widehat{\text{\textbf{B}}},
\end{gather*}
где $\widehat{\text{\textbf{K}}}^{Loc}$ и $\widehat{\text{\textbf{K}}}^{NonLoc}$ --- тензоры четвёртого ранга, соответствующие матрицам жёсткости для локальной и нелокальной постановок соответственно;

$\widehat{\text{\textbf{U}}}$ --- тензор второго ранга, соответствующий вектору искомых узловых перемещений;

$\widehat{\text{\textbf{P}}}$ --- тензор второго ранга, дискретизация вектора плотности поверхностных сил;

$\widehat{\text{\textbf{B}}}$ --- тензор второго ранга, дискретизация вектора плотности объёмных~сил.

Воспользуемся соотношением Коши (\ref{DefineStrains}) и заменим перемещения $\boldsymbol{u}$ интерполяционными соотношениями, то есть представим в виде конечной суммы $\boldsymbol{u}(\boldsymbol{x}) \approx \boldsymbol{u}_m N_m^{(e)}(\boldsymbol{x})$, $m \in I^{(e)}$, где $\boldsymbol{u}_m$ -- искомые перемещения в $m$-ом узлe. Также для простоты дальнейших выкладок, введём тензор $\widehat{\text{\textbf{K}}}_{nm}^{(e)(e')}$, который в сущности представляет из себя блок $2 \times 2$ в $n$-ой строке и $m$-ом столбце матрицы жёсткости $\widehat{\text{\textbf{K}}}$. Тогда компоненты тензора $\widehat{\text{\textbf{K}}}_{nm}^{(e)(e')}$ можно определить следующим образом
\begin{gather*}
	K_{nmij}^{(e)(e')} (\boldsymbol{x}, \boldsymbol{y}) = 
	\delta_{np} \delta_{mq} C_{ikjl} 
	N_{n, k}^{(e)}(\boldsymbol{x}) 
	N_{m, l}^{(e')} (\boldsymbol{y}) \boldsymbol{e}_{i} \otimes \boldsymbol{e}_j \otimes \boldsymbol{E}_p \otimes \boldsymbol{E}_q, \\ \\
	i,j,k,l = \overline{1, 2},
	\quad
	n,m,p,q = \overline{1, L},
\end{gather*}
где $L$ --- количество узлов сетки; $\boldsymbol{E}_i$ --- единичный вектор, размерности $L$. 

\noindent Тогда аппроксимацию матрицы $\widehat{\text{\textbf{K}}}^{Loc}$ можно записать в следующем \mbox{виде}:
\begin{gather}
	\label{KLocApprox1}
	\widehat{\text{\textbf{K}}}^{Loc} =
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n, m \in I^{(e)}}
	\sum\limits_{q \in Q^{(e)}}
	w_q \widehat{\text{\textbf{K}}}_{nm}^{(e)(e)}(\boldsymbol{x}_q, \boldsymbol{x}_q) J_q^{(e)},
\end{gather}
где $Q^{(e)}$ --- множество квадратурных узлов на элементе $(e)$;

$\boldsymbol{x}_q$ --- коордианата квадратурного узла $q$;

$w_q$ --- квадратурный вес в квадратурном узле $q$;

$J_q^{(e)} = \left|\det{\widehat{\text{\textbf{J}}}^{(e)}(\boldsymbol{x}_q)}\right|$ --- якобиан вычисленный в квадратурной точке $\boldsymbol{x}_q$.

Зону нелокального влияния $S'(\boldsymbol{x})$ аппроксимируем относительно каждого квадратурного узла сетки в отдельности \cite{Pisano}. Тогда, те элементы $(e)$, квадратурные узлы $Q^{(e)}$ которых хотя бы частично попали в область влияния, будут участвовать в расчёте. Таким образом, аппроксимацию матрицы $\widehat{\text{\textbf{K}}}^{NonLoc}$ можно записать в виде:
\begin{multline}
	\label{KNonLocApprox1}
	\widehat{\text{\textbf{K}}}^{NonLoc} =
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n \in I^{(e)}}
	\sum\limits_{q \in Q^{(e)}}
	w_q J_q^{(e)}
	\times \\ \\ \times
	\sum\limits_{(e') \in S_h^{q}}
	\sum\limits_{m' \in I^{(e')}}
	\sum\limits_{q' \in Q^{(e')}}
	w_{q'} \varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) \widehat{\text{\textbf{K}}}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}.
\end{multline}

Иллюстрация такого способа аппроксимации наглядно проиллюстрирована на рис. \ref{fig:ApproxSQ}, где квадратурные узлы помечены точками, а квадратурный узел относительного которого происходит аппроксимация помечен крестом. Аппроксимированная зона нелокального влияния $S_h^{q} \subset S_h$ выделена серым цветом.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{pics/ApproxSQ.eps}
	\caption{Аппроксимация зоны нелокального влияния относительно квадратурного узла сетки}
	\label{fig:ApproxSQ}
\end{figure}

Аппроксимацию вектора плотности поверхностных сил $\widehat{\text{\textbf{P}}}$ и вектора плотности объёмных сил $\widehat{\text{\textbf{B}}}$ запишем в следующем виде
\begin{gather}	
	\label{PArrpox1}
	\widehat{\text{\textbf{P}}} =
	\sum\limits_{(be) \in \Gamma_h}
	\sum\limits_{n \in I^{(be)}} 
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)}(\boldsymbol{x}_q) \boldsymbol{p}(\boldsymbol{x}_q) J_q^{(be)},
	\\[4ex]
	\label{BArrpox1}
	\widehat{\text{\textbf{B}}} =
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n \in I^{(e)}}
	\boldsymbol{E}_n \otimes
	\sum\limits_{q \in Q^{(e)}}
	w_q N_{n}^{(e)} (\boldsymbol{x}_q) \boldsymbol{b} (\boldsymbol{x}_q) J_q^{(e)},
\end{gather}
где $\Gamma_h \subset S_h$ --- конечно-элементная модель границы области $S$; 

$(be) \in \Gamma_h$ --- одномерные элементы заданные на границе;

Вычисление матриц (\ref{KLocApprox1}) и (\ref{KNonLocApprox1}) можно упростить записав производные от функций форм в локальной системе координат элементов $(e) \in S_h$
\begin{gather*}
	\dfrac{\partial N_i^{(e)}}{\partial x_k} =
	\dfrac{\partial N_i^{(e)}}{\partial \xi_j^{(e)}}
	\dfrac{\partial \xi_j^{(e)}}{\partial x_k}, \quad
	j, k = \overline{1, 2}, \ i \in I^{(e)}.
\end{gather*}
Якобиан на границе аппроксимируем следующим образом
\begin{gather*}
	J^{(be)} = \sqrt{
	\left( x_{1i} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2 +
	\left( x_{2i} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2	
	}, \quad
	i \in I^{(be)}, \ (be) \in \Gamma_h.
\end{gather*}
Заметим, что индекс оси $\xi^{(e)}$ не ставится, так как элемент одномерный.




\newpage



\section{Программная реализация}

\subsection{Аппроксимация зоны нелокального влияния}

Основная сложность, которая возникает при решении задачи (\ref{EquilibriumEquation}), является аппроксимация интегрального слагаемого в (\ref{DefineSigma}), так как в матрицах элементов необходимо учитывать влияние, которое приходится на соседние элементы. Действуя по правилам аппроксимации вложенных интегралов мы приходим к тому, что в уравнении (\ref{KNonLocApprox1}) порядок сумм заставляет аппроксимировать зону нелокального влияния для каждого квадратурного узла сетки, что не очень практично, так как выполнять поиск ближайших соседей относительно квадратурных узлов может быть весьма затратной процедурой, а хранение индексов элементов, которые попадают в зону влияния, очень дорогим. Более того, такой подход попросту сложно реализовать программно, поэтому возникает предложение аппроксимировать зону нелокального влияния относительно центров элементов и учитывать в расчётах те элементы, центры которых попали в зону влияния \cite{Sokolov}. Тогда формула (\ref{KNonLocApprox1}) принимает~вид:
\begin{multline}
	\label{KNonLocApprox2}
	\widehat{\text{\textbf{K}}}^{NonLoc} =
	\sum\limits_{(e) \in S_h}
	\sum\limits_{n \in I^{(e)}}
	\sum\limits_{(e') \in S_h^{(e)}}
	\sum\limits_{m' \in I^{(e')}}
	\sum\limits_{q \in Q^{(e)}}
	w_q J_q^{(e)}
	\times \\ \\ \times
	\sum\limits_{q' \in Q^{(e')}}
	w_{q'} \varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) \widehat{\text{\textbf{K}}}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}.
\end{multline}
где $S_h^{(e)} \subset S_h$ --- зона влияния аппроксимированная на элементе~$(e)$.

Такой способ аппроксимации проиллюстрирован на рис. \ref{fig:ApproxS}, где центры элементов помечены точками, текущий элемент относительно которого проводится аппроксимация помечен крестом, а аппроксимированная зона закрашена серым цветом.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{pics/ApproxS.eps}
	\caption{Аппроксимация зоны нелокального влияния относительно центра конечного элемента}
	\label{fig:ApproxS}
\end{figure}

Заметим, что в формуле (\ref{KNonLocApprox2}) изменён порядок знаков суммирования, а значит, и порядок действий. С точки зрения написания вычислительной программы это означает лишь перестановку циклов и введение дополнительных массивов индексов. Для успешного интегрирования зону аппроксимации лучше всего брать несколько больше, нежели реальная зона нелокального влияния $r$, таким образом возникает шанс того, что все квадратурные узлы, которые попали под зону влияния $S'(\boldsymbol{x})$, будут учтены в расчёте. Естественно, радиус поиска следует определять исходя из грубости сетки, что наглядно продемонстрировано на рис. \ref{fig:ApproxS}.

\subsection{Распараллеливание алгоритма}

Учитывая высокую вычислительную сложность подобных задач разумно использовать возможности современных вычислительных систем, а именно параллельные и распределённые вычисления. К сожалению, обход сетки, который задаётся порядком суммирования в (\ref{KLocApprox1}) и (\ref{KNonLocApprox2}), не позволяет эффективно использовать такие возможности, поэтому возникает предложение определить другой порядок обхода сетки, в котором не будет проблем, связанных с гонкой данных и который позволит собирать части матрицы независимо сразу в нескольких процессах. Этого можно достичь определив для каждого узла сетки $n \in S_h$ множество элементов $E^{n}$, которым он принадлежит. Такой подход позволяет эффективно использовать возможности параллельных и распределённых систем, так как каждая строка матрицы вычисляется независимо от всех остальных. Таким образом формулу (\ref{KLocApprox1}) можно представить в следующей форме:
\begin{gather}
	\label{KLocApprox3}
	\widehat{\text{\textbf{K}}}^{Loc} =
	\sum\limits_{n \in I^{(e)}}
	\sum\limits_{(e) \in E^{n}}
	\sum\limits_{m \in I^{(e)}}
	\sum\limits_{q \in Q^{(e)}}
	w_q \widehat{\text{\textbf{K}}}_{nm}^{(e)(e)}(\boldsymbol{x}_q, \boldsymbol{x}_q) J_q^{(e)}.
\end{gather}
Для матрицы жёсткости $\widehat{\text{\textbf{K}}}^{NonLoc}$ формула (\ref{KNonLocApprox2}) приобретает вид
\begin{multline}
	\label{KNonLocApprox3}
	\widehat{\text{\textbf{K}}}^{NonLoc} =
	\sum\limits_{n \in I^{(e)}}
	\sum\limits_{(e) \in E^{n}}
	\sum\limits_{(e') \in S_h^{(e)}}
	\sum\limits_{m' \in I^{(e')}}
	\sum\limits_{q \in Q^{(e)}}
	w_q J_q^{(e)}
	\times \\ \\ \times
	\sum\limits_{q' \in Q^{(e')}}
	w_{q'} \varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}) \widehat{\text{\textbf{K}}}_{nm'}^{(e)(e')} (\boldsymbol{x}_q, \boldsymbol{x}_{q'}) J_{q'}^{(e')}.
\end{multline}
Так же преобразуем и формулу (\ref{BArrpox1})
\begin{gather}
	\label{BArrpox3}
	\widehat{\text{\textbf{B}}} =
	\sum\limits_{n \in I^{(e)}}
	\boldsymbol{E}_n \otimes
	\sum\limits_{(e) \in E^{n}}
	\sum\limits_{q \in Q^{(e)}}
	w_q N_{n}^{(e)} (\boldsymbol{x}_q) \boldsymbol{b} (\boldsymbol{x}_q) J_q^{(e)}.
\end{gather}
Для общности, сделаем аналогичную процедуру и для аппроксимации граничных условий второго рода (\ref{PArrpox1})
\begin{gather}
	\label{PArrpox3}
	\widehat{\text{\textbf{P}}} =
	\sum\limits_{n \in \Gamma_h}
	\boldsymbol{E}_n \otimes
	\sum\limits_{(be) \in E^{n}} 
	\sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)}(\boldsymbol{x}_q) \boldsymbol{p}(\boldsymbol{x}_q) J_q^{(be)}.
\end{gather}
Стоит добавить, что для аппроксимации граничных условий второго рода менять порядок циклов не обязательно, так как данная операция, как правило, не является трудозатратной и поэтому её проще всего реализовать согласно классическому представлению, добавив лишь дополнительные условия по заполнению массивов в самой программе.

\subsection{Балансировка данных}

Как уже было сказано, поузловой обход сетки (\ref{KLocApprox3})-(\ref{BArrpox3}) позволяет достаточно эффективно использовать параллельные и распределённые вычисления. Однако при распределённых вычислениях возникает проблема балансировки данных между процессами, так как если раздать обработку узлов сетки между процессами равномерно, то данные могут иметь неравномерное распределение, что может привести к слишком высоким затратам вычислительных ресурсов на некоторых узлах кластера, в то время как остальным придётся проводить время в ожидании. Такой дисбаланс также может привести к тому, что на некоторых узлах кластера может не хватить оперативной памяти, хотя потенциально такая задача могла бы поместиться при равномерном распределении данных. В таком случае необходимо делать балансировку данных между процессами.

Идеальная балансировка подразумевает распределение данных таким образом, чтобы потребляемые объёмы оперативной памяти и объёмы вычислений на всех процессах были одинаковыми, но практика показывает, что добиться такой балансировки в общем случае не удаётся, поэтому опишем два возможных варианта балансировки.

Первый вариант позволяет добиться равномерного распределения объёмов потребляемой оперативной памяти между процессами $P$. Этот вариант балансировки подразумевает под собой осреднение количества элементов матрицы между процессами $p \in P$. Чтобы этого добиться, необходимо подсчитать количество элементов матрицы $M_p$, которыми владеет каждый из процессов. Затем сложить все эти суммы $M = \sum\limits_{p \in P} M_p$ и взять среднее по количеству процессов $M_m = M/|P|$. После этого распределить узлы таким образом, чтобы количество элементов матрицы на каждом из процессов $\widetilde{M}_p$ было примерно одинаковым, то есть $\widetilde{M}_p \approx M_m$. Для подсчёта количества элементов в матрице не требуется формировать полный портрет матрицы на каждом процессе, это можно делать построчно, что гораздо эффективнее и не приводит к высоким затратам оперативной памяти.

Второй вариант балансировки позволяет добиться равномерного распределения объёмов вычислений. Такой вариант балансировки достигается аналогичными методами, но в качестве осредняемого параметра выбирается количество вызовов функции интегрирования.




\newpage



\section{Результаты расчётов}

\subsection{Результаты распараллеливания}

Проведём серию расчётов на гибридном вычислительном кластере \mbox{K-10} \cite{K10}, где на каждом узле кластера установлено по два процессора Intel Xeon E5-2660 и по 128 Гб оперативной памяти. В качестве тестовой задачи возьмём задачу на области $S = [0, 1] \times [0, 1]$, с введённой на ней равномерной сеткой $S_h$ состоящей из квадратичных серендиповых элементов. В качестве функции нелокального влияния выберем $\varphi = \varphi_{2,1}$, так как данная функция требует наименьшее количество вычислений, но при этом обеспечивает уменьшение влияния на расстоянии. Матрицы, получаемые в расчётах, имеют симметричную и разреженную структуру, поэтому для удобства будем хранить их в CSR формате \cite{CSR}. Для индексации будем использовать 64-х битные числа, а для значений коэффициентов будем использовать числа с плавающей точкой двойной точности.

В табл. \ref{Tab:OpenMP} представлены данные об объёмах затрачиваемой оперативной памяти и времени счёта на одном и 16 потоках. Из таблицы видно, что рост требований вычислительных ресурсов квадратичный относительно количества конечных элементов и радиуса поиска ближайших соседей для нелокальной постановки задачи, в то время как для классической постановки рост требований линейный. Связано это с тем, что среднее число ближайших соседей, приходящихся на каждый конечный элемент, растёт квадратично. Однако, стоит заметить, что эффективность распараллеливания для нелокальных задач намного выше, чем для классических, что более наглядно проиллюстрировано на рис. \ref{fig:OpenMPAcceleration}.

При использовании параллельных и распределённых вычислений одновременно удаётся достичь ещё большего ускорения сборки матрицы жёсткости. Для демонстрации возможностей распределённых вычислений будем использовать 4 узла кластера и запустим на каждом процессы с 16 потоками. Случай с равномерным распределением узлов между процессами опустим и сразу рассмотрим случаи с балансировками, которые были описаны ранее.

\begin{table}[H]
	\centering
	\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		Количество & Радиус  & Среднее & Требуемый & Время     & Время,     \\
		конечных   & поиска  & число   & объём     & расчёта   & расчёта    \\
		элементов  & соседей & соседей & памяти    & 1 поток   & 16 потоков \\
		\hline
		2500       & 0       & ---     & 3.7 Мб    & 0.031 с   & 0.017 с    \\
		\hline
		10000      & 0       & ---     & 15 Мб     & 0.152 с   & 0.046 с    \\
		\hline
		40000      & 0       & ---     & 59 Мб     & 1.280 с   & 0.207 с    \\
		\hline
		2500       & 0.1     & 66      & 63 Мб     & 4.385 с   & 0.307 с    \\
		\hline
		10000      & 0.1     & 281     & 916 Мб    & 76.65 с   & 5.102 с    \\
		\hline
		40000      & 0.1     & 1143    & 13.3 Гб   & 1265 с    & 82.32 с    \\
		\hline
		2500       & 0.2     & 257     & 210 Мб    & 17.40 с   & 1.166 с    \\
		\hline
		10000      & 0.2     & 1042    & 3.1 Гб    & 288.4 с   & 18.71 с    \\
		\hline
		40000      & 0.2     & 4194    & 47 Гб     & 4704 с   &  303.2 с    \\
		\hline
	\end{tabular}
	\caption{Затрачиваемые вычислительные ресурсы на различных сетках и при различных радиусах поиска ближайших соседей}
	\label{Tab:OpenMP}
\end{table}

\begin{figure}[H]
	\center{\includegraphics[width=0.7\textwidth]{pics/OpenMPAcceleration.eps}}
	\caption{Ускорение времени сборки матрицы жёсткости при использовании технологии OpenMP на 16 потоках в сравнении со временем счёта на 1 потоке}
	\label{fig:OpenMPAcceleration}
\end{figure}

При балансировке объёмов вычислений получаем равномерное распределение времени счёта, но при этом наблюдаем сильный дисбаланс в распределении объёмов затрачиваемой оперативной памяти. Исходя из результатов, представленных в табл. \ref{Tab:SpeedBalancing}, на четвёртом процессе объёмы используемой оперативной памяти в два раза выше, чем у всех остальных процессов, что объясняется количеством самопересекающихся индексов приходящихся на каждый из процессов. На рис. \ref{fig:SpeedBalancingHist}, на примере задачи на сетке состоящей из 40000 элементов и радиусом поиска $\tilde{r} = 0.2$, наглядно проиллюстрированы распределения времени счёта и объёмы затрачиваемой оперативной памяти.

\begin{table}[!hb]
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
	\hline
	$N$   & $\tilde{r}$ & $V_1$  & $V_2$  & $V_3$   & $V_4$  & $t_{16}^1$, с & $t_{16}^2$, с & $t_{16}^3$, с &  $t_{16}^4$, с \\
	\hline
	10000 & 0.1 & 181 Мб & 173 Мб & 174 Мб & 388 Мб & 1.269         & 1.312         & 1.222         & 1.482 \\
	\hline
	10000 & 0.2 & 607 Мб & 582 Мб & 587 Мб  & 1.3 Гб & 4.736         & 4.508         & 4.474         & 5.376 \\
	\hline
	40000 & 0.1 & 2.5 Гб & 2.5 Гб & 2.5 Гб  & 5.8 Гб & 20.34         & 20.93         & 19.54        & 23.48 \\
	\hline
	40000 & 0.2 & 8.8 Гб & 8.7 Гб & 8.9 Гб & 20.6 Гб & 71.63         & 75.31         & 77.42        & 86.76 \\
	\hline
	\end{tabular}
	\caption{Распределение объёмов данных и времени выполнения между процессами при балансировке объёмов вычислений}
	\label{Tab:SpeedBalancing}
\end{table}

\begin{figure}[!hb]
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\linewidth]{pics/TimeSpeedBalancing.eps}
    \caption{} \label{fig:TimeSpeedBalancing}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\linewidth]{pics/MemorySpeedBalancing.eps}
    \caption{} \label{fig:MemorySpeedBalancing}
  \end{subfigure}
  \caption{Распределение времени счёта (а) и объёмов используемой оперативной памяти (б) при балансировке объёмов вычислений}
  \label{fig:SpeedBalancingHist}
\end{figure}

Решением проблемы дисбаланса в использовании оперативной памяти является балансировка количества элементов матрицы между процессами. При такой балансировке данные распределяются равномерно, но при этом неравномерным становится время вычисления коэффициентов. Результаты расчётов представлены в табл. \ref{Tab:MemoryBalancing}. Как и в предыдущем случае, на примере задачи на сетке состоящей из 40000 элементов и радиусом поиска ближайших соседей $\tilde{r} =~0.2$, проиллюстрируем на рис. \ref{fig:MemoryBalancingHist} диаграммы распределения времени счёта и объёмов потребляемой памяти.

\begin{table}[!htb]
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
	\hline
	$N$   & $\tilde{r}$ & $V_1$  & $V_2$  & $V_3$  & $V_4$  & $t_{16}^1$, с & $t_{16}^2$, с & $t_{16}^3$, с & $t_{16}^4$, с \\
	\hline
	10000 & 0.1 & 225 Мб & 229 Мб & 233 Мб & 229 Мб & 1.675         & 1.786         & 1.123        & 0.887 \\
	\hline
	10000 & 0.2 & 768 Мб & 782 Мб & 797 Мб & 782 Мб & 5.704         & 6.029         & 3.918        & 3.159 \\
	\hline
	40000 & 0.1 & 3.3 Гб & 3.3 Гб & 3.4 Мб & 3.3 Гб & 26.74         & 27.96         & 16.91         & 13.70 \\
	\hline
	40000 & 0.2 & 11.6 Гб & 11.7 Гб & 11.9 Гб & 11.8 Гб & 95.76     & 99.08         & 60.50         & 50.03  \\
	\hline
	\end{tabular}
	\caption{Распределение объёмов данных и времени выполнения между процессами при балансировке количества элементов матрицы}
	\label{Tab:MemoryBalancing}
\end{table}

\begin{figure}[!hb]
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\linewidth]{pics/TimeMemoryBalancing.eps}
    \caption{} \label{fig:TimeMemoryBalancing}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\linewidth]{pics/MemoryMemoryBalancing.eps}
    \caption{} \label{fig:MemoryMemoryBalancing}
  \end{subfigure}
  \caption{Распределение времени счёта (а) и объёмов используемой оперативной памяти (б) при балансировке количества элементов матрицы}
  \label{fig:MemoryBalancingHist}
\end{figure}

\newpage

Подытожим результаты использования распределённых вычислений диаграммой представленной на рис. \ref{fig:MPIAcceleration}. Из данной диаграммы видно, что при использовании распределённых вычислений наблюдается существенное ускорение времени счёта независимо от используемой балансировки. Однако, стоит отметить, что при балансировке объёмов вычислений время счёта ускоряется сильнее. Данный разрыв может быть больше, например, при другой нумерации узлов или принципиально другой геометрии области $S$. В любом случае, результаты показывают высокую эффективность и целесообразность использования такого вида вычислений.

\begin{figure}[!htb]
	\center{\includegraphics[width=0.7\textwidth]{pics/MPIAcceleration.eps}}
	\caption{Ускорение времени сборки матрицы жёсткости при использовании технологии MPI, где speed означает балансировку объёмов вычислений, а mem балансировку объёмов памяти}
	\label{fig:MPIAcceleration}
\end{figure}

\begin{comment}

\subsection{Задача Неймана и проверка принципа Сен-Венана}

Далее, во всех расчётах будем использовать безразмерные параметры и переменные
\begin{gather*}
	\boldsymbol{\overline{\sigma}} = \dfrac{\boldsymbol{\sigma}}{\sigma_0},
	\quad
	\boldsymbol{\overline{x}} = \dfrac{\boldsymbol{x}}{L},
	\quad
	\overline{E} = \dfrac{E}{\sigma_0},
	\quad
	\boldsymbol{\overline{u}} = \dfrac{\overline{E} \boldsymbol{u}}{(1 - \nu^2) L},
\end{gather*}
где $L$ --- характерный размер области; $\sigma_0$ --- нормировочный множитель для нагружений; черта над переменными означает, что они безразмерны. Примем коэффициент Пуассона $\nu = 0.3$, а безразмерный модуль Юнга $\overline{E} = 21$. Будем полагать, что если не указано иного, функция нелокального влияния $\varphi = \varphi_{2, 1}$. 

При исследовании нелокальных моделей упругости важно опираться на принципы классической теории упругости, одним из которых является принцип Сен-Венана, согласно которому различные, но статически эквивалентные нагрузки вызывают в пластине одинаковые напряженные состояния вдали от точек приложения \cite{MSS}. Данное явление не доказано в общем случае, но подтверждается многими теоретическими и экспериментальными исследования. Для проверки применимости принципа Сен-Венана к нелокальным задачам упругости рассмотрим задачу Неймана на области $S = [0, 10] \times [0, 1]$, с введённой на ней равномерной сеткой $S_h$, состоящей из 64000 квадратичных серендиповых элементов. Поставим следующие граничные условия
\begin{gather*}
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = 0} = -f(\overline{x}_2),
	\quad
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = 10} = f(\overline{x}_2),
\end{gather*}
где $f(\overline{x}_2)$ --- некоторая функция нагружения. Для получения единственности решения поставленной задачи, добавим два геометрических условия, которые так же нам дадут симметрию решения и зафиксируют его относительно центра масс области по каждой из осей
\begin{gather*}
	\overline{u}_1 |_{\overline{x}_1 = 5} = 0,
	\quad
	\overline{u}_2 |_{\overline{x}_2 = 0.5} = 0.
\end{gather*}
В классической постановке задачи, в силу симметрии, можно было бы обойтись рассмотрением лишь четверти области, но в нелокальной постановке приходится учитывать поиск ближайших соседей, который не допускает рассмотрения части области $S$.

Рассмотрим три случая нагружения с одинаковой нормировкой на области $A = \{ \overline{x}_2 : 0 \leqslant \overline{x}_2 \leqslant 1 \}$
\begin{gather*}
	f_1 (\overline{x}_2) = 1,
	\\ \\
	f_2 (\overline{x}_2) = 
	\begin{cases}
		4(\overline{x}_2), & (\overline{x}_2) \leqslant 0.5, \\ \\
		4 - 4(\overline{x}_2), & (\overline{x}_2) > 0.5,
	\end{cases}
	\\ \\
	f_3 (\overline{x}_2) =
	\begin{cases}
		2 - 4(\overline{x}_2), & (\overline{x}_2) \leqslant 0.5, \\ \\
		4(\overline{x}_2) - 2, & (\overline{x}_2) > 0.5.
	\end{cases}
\end{gather*}

На рис. \ref{fig:LongRectStress11VarFx205} и \ref{fig:LongRectStress11VarFx200} изображены напряжения $\overline{\sigma}_{11}$ вдоль оси нагружения в различных сечениях. Несмотря на различный характер нагружений, в центре масс области напряжения принимают одинаковую форму, которая в нелокальной постановке, в отличие от классической, не является константой вдоль оси $\overline{x}_2$. Расчётные параметры и выбранные сечения указаны на рисунках.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarFx205.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ в сечении $\overline{x}_2 = 0.5$ при различных нагружениях.}
	\label{fig:LongRectStress11VarFx205}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarFx200.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ в сечении $\overline{x}_2 = 0$ при различных нагружениях.}
	\label{fig:LongRectStress11VarFx200}
\end{figure}

Рассматривая центральное сечение вдоль другой оси, можем убедиться в том, что в нелокальной постановке поверхность напряжений $\overline{\sigma}_{11}$ имеет более сложную форму. Вариация весоворого параметра $p_1$ влияет на отклонение напряжений на границе, в то время как вариация радиуса нелокального влияния $r$ влияет на размах кромочного эффекта. Важно отметить, что интегральная нагрузка в каждом сечении равна приложенной, что говорит нам о выполнении принципа Сен-Венана. Результаты расчётов представлены на рис. \ref{fig:LongRectStress11VarP} и \ref{fig:LongRectStress11VarR}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarP.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ в сечении $\overline{x}_1 = 5$ при вариации $p_1$}
	\label{fig:LongRectStress11VarP}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectStress11VarR.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ в сечении $\overline{x}_1 = 5$ при вариации $r$}
	\label{fig:LongRectStress11VarR}
\end{figure}

В деформации $\overline{\varepsilon}_{11}$ кромочный эффект проявляется лишь вблизи приложения нагрузки. При увеличении радиуса нелокального влияния $r$, так же, как и в напряжении, увеличивается размах кромочного эффекта, а при уменьшении весового параметра $p_1$ отклонение от решения задачи в классической постановке увеличивается, что продемонстрировано на рис. \ref{fig:LongRectEps11VarR} и \ref{fig:LongRectEps11VarP}. В силу того, что размах кромочного эффекта достаточно узкий в  сравнии с размерами области, на рисунках отображается лишь часть области, где деформация отлична от константы.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectEps11VarR.eps}}
	\caption{Распределение деформация $\overline{\varepsilon}_{11}$ в сечении $\overline{x}_1 = 5$ при вариации $r$}
	\label{fig:LongRectEps11VarR}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectEps11VarP.eps}}
	\caption{Распределение деформация $\overline{\varepsilon}_{11}$ в сечении $\overline{x}_1 = 5$ при вариации $p_1$}
	\label{fig:LongRectEps11VarP}
\end{figure}

Стоит отметить, что в отличие от классической постановки, в нелокальной также возникают касательные напряжения $\overline{\sigma}_{12}$. Их характер имеет весьма сложную, но симметричную структуру. На рис. \ref{fig:LongRectSigma12X1} и \ref{fig:LongRectSigma12X2} изображены кривые в сечениях отстоящих от границы на величину радиуса нелокального влияния при различных весовых параметрах. Похожие результаты, но только на другой области, были получены в статье \cite{Abdollahi}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectSigma12X1.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{12}$ в сечении $\overline{x}_2 = 0.1$}
	\label{fig:LongRectSigma12X1}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectSigma12X2.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{12}$ в сечении $\overline{x}_1 = 0.1$}
	\label{fig:LongRectSigma12X2}
\end{figure}

Вариация основных параметров семества функций нелокального влияния (\ref{phi}) показывает, что в перемещениях $\overline{u}_1$ в нелокальной постановке наблюдается увеличение отклонения относительно классического решения при увеличении параметра $p$ и достигает своего максимума при константной функции влияния. При увеличении параметра $q$, напротив, отклонение в перемещениях уменьшается, что наглядно продемонстрировано на рис. \ref{fig:LongRectDispVarP} и \ref{fig:LongRectDispVarQ} соответственно, где показаны не сами отклонения, а относительная разница решений и где было выбрано сечение с наибольшим отклонением.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectDispVarP.eps}}
	\caption{Относительная разница нелокального и локального решений при вариации параметра $p$}
	\label{fig:LongRectDispVarP}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/LongRectDispVarQ.eps}}
	\caption{Относительная разница нелокального и локального решений при вариации параметра $q$}
	\label{fig:LongRectDispVarQ}
\end{figure}

Таким образом, выбор функции нелокальго влияния может повлиять на итоговое решение, но так как все рассматриваемые функции относились к единому семейству полиномиальных функций, качественно решение остаётся неизменным.


\subsection{Расчёт на Т-образной области}

Пусть теперь $S \subset [0, 1] \times [0, 1]$ --- T-образная область, изображённая на рис. \ref{fig:Tarea}, с введённой на ней равномерной сеткой $S_h$, состоящей из 30000 квадратичных серендиповых элементов. Также на рис. \ref{fig:Tarea} отметим интересующие нас сечения. Коэффициент Пуассона $\nu$ по прежнему равен $0.3$, а безразмерный модуль Юнга $\overline{E} = 21$. Функция нелокального влияния $\varphi = \varphi_{2,1}$. Будем действовать растягивающей силой приложенной к нижнему концу пластины, верхний конец жёстко заделаем
\begin{gather*}
	\boldsymbol{\overline{u}} |_{\overline{x}_2 = 1} = 0,
	\quad
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = 0} = -1.
\end{gather*}

\begin{figure}[!h]
	\center{\includegraphics[width=0.6\textwidth]{pics/T/Tarea.eps}}
	\caption{T-образная область с заданными граничными условиями и интересующими нас сечениями}
	\label{fig:Tarea}
\end{figure}

Проведём серию расчётов, варьируя основные параметры модели. При рассмотрении деформации $\overline{\varepsilon}_{22}$, помимо эффектов, связанных с приложенной нагрузкой, которые были описаны в предыдущем разделе на примере задачи Неймана, возникают и угловые эффекты, которые характеризуются возникающими отрицательными деформациями со стороны верхней части области. Причём, чем больше радиус нелокального влияния $r$, тем шире возникающий эффект, что наглядно показано на рис. \ref{fig:TEps}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TEpsLoc.png}
    \caption{} \label{fig:TEpsLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TEpsNonlocP12R005.png}
    \caption{} \label{fig:TEpsNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TEpsNonlocP12R01.png}
    \caption{} \label{fig:TEpsNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TEpsNonlocP12R015.png}
    \caption{} \label{fig:TEpsNonlocP12R015}
  \end{subfigure}
  \caption{Распределение деформации $\overline{\varepsilon}_{22}$ в Т-образной области при $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.15$. Случай а) соответствует классической постановке задачи}
  \label{fig:TEps}
\end{figure}

Схожие угловые эффекты в деформации $\overline{\varepsilon}_{22}$ ранее были описаны в книге Андреева А.В. \cite{Andreev} после проведения серии экспериментов. В этой работе автор также утверждает, что интегральная нагрузка напряжений $\overline{\sigma}_{22}$ в сечениях близких к ступенчатому переходу может отличаться от прикладываемой нагрузки, однако данный эффект не удалось обнаружить численно, так как во всех сечениях, даже самых близких к ступенчатому переходу, интегральная нагрузка сохраняется. Однако, стоит заметить, максимальное значение напряжений в концентраторах уменьшилось. Результаты с распределением напряжений $\overline{\sigma}_{22}$ продемонстрированы на рис. \ref{fig:TSigma}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TSigmaLoc.png}
    \caption{} \label{fig:TSigmaLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TSigmaNonlocP12R005.png}
    \caption{} \label{fig:TSigmaNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TSigmaNonlocP12R01.png}
    \caption{} \label{fig:TSigmaNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/T/TSigmaNonlocP12R015.png}
    \caption{} \label{fig:TSigmaNonlocP12R015}
  \end{subfigure}
  \caption{Распределение напряжения $\overline{\sigma}_{22}$ в Т-образной области при $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.15$. Случай а) соответствует классической постановке задачи}
  \label{fig:TSigma}
\end{figure}

Теперь же, рассмотрим деформации и напряжения в сечениях, которые указаны на рис. \ref{fig:Tarea}, но уже при вариации весового параметра $p_1$. В сечении AB в деформации $\overline{\varepsilon}_{22}$, изображённых на рис. \ref{fig:AB_eps_r01}, можно наблюдать влияние кромочного эффекта вблизи приложенной нагрузки, которое говорит о неравномерности деформирования вблизи границ области, несмотря на равномерную нагрузку. В напряжении $\overline{\sigma}_{22}$ из-за этого наблюдается <<двугорбая>> структура, которая изображена на рис. \ref{fig:AB_sigma_r01}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/AB_eps_r01.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ в Т-образной области в сечении AB при вариации весовых параметров}
	\label{fig:AB_eps_r01}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/AB_sigma_r01.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в Т-образной области в сечении AB при вариации весовых параметров}
	\label{fig:AB_sigma_r01}
\end{figure}

В сечении CD над кромочным эффектом от нагружения на нижнем конце пластины начинает преобладать угловой эффект, который даёт <<двугорбые>> структуры в деформации $\overline{\varepsilon}_{22}$ и напряжении $\overline{\sigma}_{22}$, изображённых на рис. \ref{fig:CD_eps_r01} и \ref{fig:CD_sigma_r01} соответственно. Деформации близки к классическим и имеют лишь количественные различия, в то время как напряжения имеют существенные отклонения вблизи границы области.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/CD_eps_r01.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ в Т-образной области в сечении CD при вариации весовых параметров}
	\label{fig:CD_eps_r01}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/CD_sigma_r01.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в Т-образной области в сечении CD при вариации весовых параметров}
	\label{fig:CD_sigma_r01}
\end{figure}

И, наконец, в сечении EF можем наблюдать угловой эффект с отрицательными значениями деформациями $\overline{\varepsilon}_{22}$, который тем сильнее, чем меньше весовой параметр $p_1$. В напряжениях $\overline{\sigma}_{22}$ наблюдается смягчение концертраторов, которое также зависит в большей степени от параметра $p_1$. Здесь, как и в предыдущих сечениях, также наблюдается пересечение напряжений в общих точках. Решения представлены на рис. \ref{fig:EF_eps_r01} и \ref{fig:EF_sigma_r01}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/EF_eps_r01.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ в Т-образной области в сечении EF при вариации весовых параметров}
	\label{fig:EF_eps_r01}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/T/EF_sigma_r01.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в Т-образной области в сечении EF при вариации весовых параметров}
	\label{fig:EF_sigma_r01}
\end{figure}

\subsection{Задача Кирша с обобщением на эллиптические вырезы}

Рассмотрим задачу Кирша \cite{Birger} с обобщением на эллиптические вырезы на области $S \subset [-1, 1] \times [-1, 1]$, со следующими граничными условиями
\begin{gather*}
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = -1} = -1,
	\quad
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 =  1} =  1.
\end{gather*}
Также добавим два дополнительных условия, которые зафиксируют область относительно главных осей и дадут симметрию решения
\begin{gather*}
	\overline{u}_i |_{\overline{x}_i = 0} = 0, \quad i = \overline{1, 2}.
\end{gather*}
Коэфициента Пуассона $\nu = 0.3$, безразмерный модуль Юнга $\overline{E} = 21$.

\begin{figure}[!h]
	\center{\includegraphics[width=0.6\textwidth]{pics/EllipticalCut.eps}}
	\caption{Область с эллиптическим вырезом, заданными нагружениями и интересуемыми сечениями}
	\label{fig:EllipticalCut}
\end{figure}

Отметим на рис. \ref{fig:EllipticalCut} сечения, которые представляют особый интерес: это сечение AB; граница эллипса CD с введённой дополнительной угловой координатой $\varphi$; и сечение EF, которое находится посередине между правой крайней точкой эллипса и правой границей области $S$. В расчётах будем варьировать радиус $R_1$, радиус $R_2$ будем считать постоянным и равным 0.2.

Сначала рассмотрим классическую задачу Кирша с круговым вырезом, т. е. когда $R_1 = R_2$. В деформации $\overline{\varepsilon}_{11}$, в областях на окружности смежных с концентраторами, возникают отрицательные значения деформации, размах которых тем шире, чем больше радиус нелокального влияния $r$. Такое поведение очень похоже на поведение, которое наблюдалось ранее в Т-образной области. Результаты представлены на рис. \ref{fig:CircleEps}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleEpsLoc.png}
    \caption{} \label{fig:CircleEpsLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleEpsNonlocP12R005.png}
    \caption{} \label{fig:CircleEpsNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleEpsNonlocP12R01.png}
    \caption{} \label{fig:CircleEpsNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleEpsNonlocP12R02.png}
    \caption{} \label{fig:CircleEpsNonlocP12R02}
  \end{subfigure}
  \caption{Распределение деформации $\overline{\varepsilon}_{11}$ в области с круговым вырезом при $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.2$. Случай а) соответствует классической постановке задачи}
  \label{fig:CircleEps}
\end{figure}

В напряжении $\overline{\sigma}_{11}$, так же, как и в Т-образной области, происходит смягчение концентраторов, вследствие чего максимальный уровень напряжения ниже, чем в классической постановке, в то время как уровень деформации $\overline{\varepsilon}_{11}$, напротив, провышается. Как и во всех расчётах до этого, здесь также наблюдается кромочный эффект на верхнем и нижнем краях области, который характеризуется снижением напряжений вблизи границы. Результаты расчётов представлены на рис. \ref{fig:CircleSigma}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleSigmaLoc.png}
    \caption{} \label{fig:CircleSigmaLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleSigmaNonlocP12R005.png}
    \caption{} \label{fig:CircleSigmaNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleSigmaNonlocP12R01.png}
    \caption{} \label{fig:CircleSigmaNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/CircleSigmaNonlocP12R02.png}
    \caption{} \label{fig:CircleSigmaNonlocP12R02}
  \end{subfigure}
  \caption{Распределение напряжения $\overline{\sigma}_{11}$ в области с круговым вырезом при $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.2$. Случай а) соответствует классической постановке задачи}
  \label{fig:CircleSigma}
\end{figure}

Наконец, расмотрим интересующие нас сечения при вариации весового параметра $p_1$. В сечении AB качественных различий в деформации $\overline{\varepsilon}_{11}$ нет, но в нелокальном случае вблизи отверстия наблюдается их увеличение. Напряжение $\overline{\sigma}_{11}$ напротив, уменьшает своё значение как вблизи отверстия, так и вблизи нижней границы области, но при этом в центре области напряжения в среднем выше, что объясняет равенство интегралов приложенной нагрузки и нагрузки, определённой в сечениях. Результаты представлены на рис. \ref{fig:ABCircleEps} и \ref{fig:ABCircleSigma}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/ABCircleEps.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ в сечении AB при вариации весов при $r_1 = 0.2$}
	\label{fig:ABCircleEps}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/ABCircleSigma.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в сечении AB при вариации весов при $r_1 = 0.2$}
	\label{fig:ABCircleSigma}
\end{figure}

На дуге CD хорошо видны возникающая в нелокальном случае отрицательная деформация $\overline{\varepsilon}_{11}$, которые при уменьшении параметра $p_1$ увеличиваются по модулю. Напряжение $\overline{\sigma}_{11}$ в верхней точке, при уменьшении параметра $p_1$ становятся меньше и в правой точке окружности практически неотличимы от полученных при решении классического уравнения. Результаты представлены на рис. \ref{fig:CDCircleEps} и \ref{fig:CDCircleSigma}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDCircleEps.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ на дуге CD при вариации весов при $r_1 = 0.2$}
	\label{fig:CDCircleEps}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDCircleSigma.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ на дуге CD при вариации весов при $r_1 = 0.2$}
	\label{fig:CDCircleSigma}
\end{figure}

И, наконец, рассмотрим сечение EF, равноостоящее от правой точки окружности и правой границы области $S$. В этом случае деформация $\overline{\varepsilon}_{11}$ и напряжение $\overline{\sigma}_{11}$ имеют <<двугорбую>> структуру, которая характеризуется снижением уровня деформации и напряжения в центре области. Однако под действием коромчного эффекта, который приходится со стороны приложенной нагрузки, деформация $\overline{\varepsilon}_{11}$ увеличиваются при приближении к границе области $S$, в то время как напряжение $\overline{\sigma}_{11}$ напротив, становится меньше и приобретает дополнительные приграничные <<горбы>>. Результаты представлены на рис.~\ref{fig:EFCircleEps}~и~\ref{fig:EFCircleSigma}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/EFCircleEps.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{22}$ в сечении EF при вариации весов}
	\label{fig:EFCircleEps}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/EFCircleSigma.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в сечении EF при вариации весов}
	\label{fig:EFCircleSigma}
\end{figure}

Теперь рассмотрим случай, когда радиус эллипса $r_1 = 0.1$. В этом случае, деформации $\overline{\varepsilon}_{11}$ на верхнем и нижнем концах эллипса становятся больше, чем в случае, когда $r_1 = r_2$. Также как и в случае с кругом, в нелокальной постановке задачи на границах эллипса смежных с концентраторами возникают отрицательные деформации, которые в два раза больше по модулю при аналогичных весовых параметрах. Результаты представлены на рис. \ref{fig:Ellipse12Eps}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12EpsLoc.png}
    \caption{} \label{fig:Ellipse12EpsLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12EpsNonlocP12R005.png}
    \caption{} \label{fig:Ellipse12EpsNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12EpsNonlocP12R01.png}
    \caption{} \label{fig:Ellipse12EpsNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12EpsNonlocP12R02.png}
    \caption{} \label{fig:Ellipse12EpsNonlocP12R02}
  \end{subfigure}
  \caption{Распределение деформации $\overline{\varepsilon}_{11}$ в области с эллиптическим вырезом при $R_1 = 0.1$, $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.2$. Случай а) соответствует классической постановке задачи}
  \label{fig:Ellipse12Eps}
\end{figure}

В распределении напряжения $\overline{\sigma}_{11}$ также наблюдается увеличение значений напряжения в концентраторах. Как и ранее, в нелокальном случае, максимальный уровень напряжения ниже, чем в классическом, и можно наблюдать кромочный эффект, который характеризуется снижением напряжения на верхней и нижней границах области. Результаты представлены на рис. \ref{fig:Ellipse12Sigma}.

\begin{figure}[!hb]
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12SigmaLoc.png}
    \caption{} \label{fig:Ellipse12SigmaLoc}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12SigmaNonlocP12R005.png}
    \caption{} \label{fig:Ellipse12SigmaNonlocP12R005}
  \end{subfigure}
  \\
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12SigmaNonlocP12R01.png}
    \caption{} \label{fig:Ellipse12SigmaNonlocP12R01}
  \end{subfigure}
  \hspace*{\fill}
  \begin{subfigure}{0.5\textwidth}
    \includegraphics[width=\linewidth]{pics/circle/Ellipse12SigmaNonlocP12R02.png}
    \caption{} \label{fig:Ellipse12SigmaNonlocP12R02}
  \end{subfigure}
  \caption{Распределение напряжения $\overline{\sigma}_{11}$ в области с эллиптическим вырезом при $R_1 = 0.1$, $p_1 = 1/2$ и б) $r = 0.05$; в) $r = 0.1$; г) $r = 0.2$. Случай а) соответствует классической постановке задачи}
  \label{fig:Ellipse12Sigma}
\end{figure}

Рассмотрим более детально разницу решений при вариации радиуса эллиптического выреза $r_1$. Ясно, что при любом радиусе $r_1$ максимальные напряжение $\overline{\sigma}_{11}$ находятся на верхней и нижней точках эллипса и для классического случая, на основе теоретических исследований \cite{Birger}, была получена следующая зависимость
\begin{gather*}
	\sigma_{11}^{max} \approx \left( 1 + 2 \dfrac{r_2}{r_1} \right) p,
\end{gather*}
\noindent где $p$ --- приложенная нагрузка. Таким образом, рассмотрев сечение AB, можем убедиться в том, что для классической постановки задачи зависимость прослеживается. В случае нелокальной постановки задачи, ситуация не столь очевидна, хотя зависимость максимального уровня напряжений от радиуса эллипса сохраняется. На рис. \ref{fig:ABDiffR1Loc} и \ref{fig:ABDiffR1NonLoc} видно, что при удалении от эллиптического выреза, решения сливаются и практически не отличаются друг от друга. В нелокальном случае на нижней границе области наблюдается понижение напряжений.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/ABDiffR1Loc.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в сечении AB в классической постановке задачи при вариации радиуса $R_1$}
	\label{fig:ABDiffR1Loc}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/ABDiffR1NonLoc.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{22}$ в сечении AB в нелокальной постановке задачи при вариации радиуса $R_1$}
	\label{fig:ABDiffR1NonLoc}
\end{figure}

Рассмотрим дугу CD, но так как при вариации $R_1$ её длина и кривизна будет разной, будем рассматривать её в относительных величинах. Для начала опишем её параметрически следующим образом
\begin{gather*}
	\begin{cases}
		x_1 (\varphi) = r_1 \cos \varphi, \\
		x_2 (\varphi) = r_2 \sin \varphi.
	\end{cases}
\end{gather*}
Длину $l$, зависящую от угла $\varphi$, определим следующим образом
\begin{gather*}
	l(\varphi) = 
		\int\limits_0^{\varphi} 
			\sqrt{
				\left( \dfrac{\partial x_1}{\partial \varphi} \right)^2 + 
				\left( \dfrac{\partial x_2}{\partial \varphi} \right)^2
			}
		d \varphi,
	\quad
	0 \leqslant \varphi \leqslant \dfrac{\pi}{2}.
\end{gather*}
И наконец перейдём к безразмерному виду
\begin{gather*}
	s(\varphi) = \dfrac{l(\varphi)}{l\left( \dfrac{\pi}{2} \right)}, 
	\quad
	0 \leqslant \varphi \leqslant \dfrac{\pi}{2}.
\end{gather*}
Дальнейшие результаты будем представлять относительно длины $s$, то есть для этого придётся определить $s^{-1} = \varphi (s)$, что легко сделать численно благодаря современным математическим пакетам. Заметим, что в случае, когда $r_1 = r_2$ данная зависимость будет линейной. В остальных случаях придётся иметь дело с эллиптическими интегралами 2-го рода.

Рассмотрим деформацию $\overline{\varepsilon}_{11}$, возникающие на дуге CD. При уменьшении радиуса $r_1$ уменьшается и длина дуги, но даже в относительных величинах, область на которой происходит концентрация деформаций стремительно сужается и деформации увеличиваются. Аналогичную картину видим и в нелокальном случае, где мы также можем видеть возникающие отрицательные деформации, которые увеличиваются по модулю и ширине при уменьшении радиуса $r_1$. Результаты расчётов задачи в классической постановке представлены на рис. \ref{fig:CDEpsLoc}, в нелокальной постановке на рис. \ref{fig:CDEpsNonLoc}.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDEpsLoc.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{11}$ на дуге CD в классической постановке задачи при вариации радиуса $R_1$}
	\label{fig:CDEpsLoc}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDEpsNonLoc.eps}}
	\caption{Распределение деформации $\overline{\varepsilon}_{11}$ на дуге CD в классической постановке задачи при вариации радиуса $R_1$}
	\label{fig:CDEpsNonLoc}
\end{figure}

Теперь рассмотрим напряжение $\overline{\sigma}_{11}$, концентраторы которых гораздо удобнее рассматривать при обходе дуги CD. Как и в случае с деформацией $\overline{\varepsilon}_{11}$, наблюдается сужение зоны концентрации. В нелокальном случае происходит смягчение концентратора и для наглядности, на рис. \ref{fig:CDSigmaLoc} и \ref{fig:CDSigmaNonLoc} выведены пиковые значения напряжений. Учитывая, что темпы роста как в локальном, так и в нелокальном законках похожи, это говорит лишь о том, что нелокальная теория не способна полностью погасить возникающие концентраторы.

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDSigmaLoc.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ на дуге CD в классической постановке задачи при вариации радиуса $R_1$}
	\label{fig:CDSigmaLoc}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=0.7\textwidth]{pics/circle/CDSigmaNonLoc.eps}}
	\caption{Распределение напряжения $\overline{\sigma}_{11}$ на дуге CD в классической постановке задачи при вариации радиуса $r_1$}
	\label{fig:CDSigmaNonLoc}
\end{figure}

\end{comment}

\newpage

\section-{ЗАКЛЮЧЕНИЕ}

В работе было рассмотрено двумерное уравнение равновесия в нелокальной постановке. Исследования показали, что несмотря на такую постановку задачи, здесь, как и в классическом случае, выполняется принцип Сен-Венана, который, в отличие от классического решения, не даёт константы вдали от приложенных нагружений, но в тоже время интегрально совпадает с ними. В областях со ступенчатыми переходами или эллиптическими вырезами наблюдается смягчение концентраторов, которое характеризуется увеличением деформаций, но снижением напряжений. Также в окрестностях концентраторов в деформациях наблюдаются отрицательные величины, которые тем больше и тем шире, чем больше вклад и радиус нелокального влияния, соответственно.


Был предложен и реализован параллельный и распределённый поузловой алгоритм сборки матрицы жёсткости на основе метода конечных элементов и написана программа на языке программирования C++. Были также предложены и реализованы различные варианты балансировки данных между процессами. Распараллеливание программы было произведено при помощи технологии параллельного программирования OpenMP \cite{OpenMP}. Распределённые вычисления были реализованы на основе технологии MPI \cite{MPI}. Для хранения и решения разреженных симметричных СЛАУ использовалась библиотека линейной алгебры Eigen \cite{Eigen}. В качестве распределённых решателей СЛАУ были использованы библиотеки PETSc \cite{PETSc} и Intel MKL PARDISO \cite{PARDISO}. Для реализации обобщённой конечно-элементной модели была использована библиотека символьного дифференцирования на этапе компиляции symdiff \cite{Krasnov}. Моделирование геометрии и генерация конечно-элементной сетки была сделана в SALOME \cite{SALOME}. Обработка результатов и выведение графиков были сделаны при помощи Paraview \cite{Paraview} и Wolfram Mathematica \cite{Wolfram}.


\newpage



\begin{thebibliography}{9}
	\bibitem{Nanomaterial} Thangadurai T.D., Manjubaashini N., Thomas S., Maria H.J. Nanostructured Materials. Springer International Publishing, 2020. 210 p.
	
	\bibitem{Eringen} Eringen A.C. Nonlocal continuum field teories. New York-Berlin-Heidelberg:
Springer-Verlag, 2002.

	\bibitem{Pisano}  Pisano A.A., Sofi A., Fuschi P., 2009. Nonlocal integral elasticity: 2D finite element based solutions. Int. J. Solids Struct. 46, 3836–3849.
	
	\bibitem{Wen} Wen P.H., Huang X.J., Aliabadi M.H. Two Dimensional Nonlocal Elasticity Analysis by Local Integral Equation Method. CMES, vol.96, no.3, pp.199-225, 2013
	
	\bibitem{Abdollahi} Abdollahi R. Benchmarks in nonlocal elasticity defined by Eringen’s integral model / Abdollahi R., Boroomand B. – Int. J. Solids Struct, 2013, 50, p. 2758–2771.
	
	\bibitem{QuadSerendipity} Астионенко И.А., Гучек П.И., Литвиненко Е.И., Хомченко А.Н. Применение альтернативных серендиповых моделей при решении задач о кручении призматических стержней. Вестник ХНТУ №1(46), 2013.
	
	\bibitem{QubicSerendipity} Астионенко И.А., Литвиненко Е.И., Хомченко А.Н. Конструирование многопараметрических полиномов на бикубическом элементе серендипова семейства. Научные ведомости БелГУ №5(60), 2009.

	\bibitem{MSS} Зарубин В.С., Кувыркин Г.Н. Математические модели механики и электродинамики сплошной среды. М.: Изд-во МГТУ им. Н.Э. Баумана, 2008. 512 с.
	
	\bibitem{SpecFunc} Абрамовица М., Стиган И. Справочник по специальным функциям. С формулами, графиками и математическими таблицами. М.: Наука, 1979. 832~с.
	
	\bibitem{Zienkiewicz} Zienkiewicz O. The Finite Element Method: Its Basis and Fundamentals. Seventh edition. / O. Zienkiewicz, R. Taylor, J.Z. Zhu --- 2013. --- 756 p.

	\bibitem{Bathe} Bathe K-J. Finite Element Procedures. Second edition. --- 2014. --- 1065 p.
	
	\bibitem{Meiz} Мейз Дж. Теория и задачи механики сплошных сред. М.: Изд-во <<Мир>>. 1974. 320 с.
	
	\bibitem{Sokolov} Kuvyrkin G.N., Savelyeva I. Yu., Sokolov A.A. Features of the software implementation of the numerical solution of stationary heat equation taking into account the effects of nonlocal finite element method. Journal of Physics: Conference Series, Volume 1479, Applied Mathematics, Computational Science and Mechanics: Current Problems 11-13 November 2019, Voronezh, Russian Federation
	
	\bibitem{K10} https://www.kiam.ru/MVS/resourses/k10.html (Дата обращения 31.03.2021)	
	
	\bibitem{CSR} Писсанецки С. Технология разреженных матриц: Пер. с англ. --- М.: Мир. 1988. --- 410 с. ил.
	
	\bibitem{Andreev}  Андреев А.В. Инженерные методы определения концентрации напряжений в деталях машин. М.: Машиностроение, 1976, 72 с.
	
	\bibitem{Birger} Биргер И.А., Шорр Б.Ф., Иосилевич Г.Б. Расчет на прочность деталей машин: Справочник. 4-е изд., перераб. и доп. --- М.: Машиностроение, 1993. --- 640 с: ил.
	
	\bibitem{OpenMP} Антонов А.С. Параллельное программирование с использованием технологии OpenMP --- М.: Изд-во Московского Университета, 2009. --- 78 с.
	
	\bibitem{MPI} Абрамян, М.Э. Параллельное программирование на основе технологии MPI 2.0 : учебник --- Ростов-на-Дону; Таганрог: Изд-во ЮФУ, 2018. --- 357~с.
	
	\bibitem{Eigen} Eigen: https://eigen.tuxfamily.org/ (Дата обращения 31.03.2021)
	
	\bibitem{PETSc} PETSc: https://www.mcs.anl.gov/petsc (Дата обращения 31.03.2021)
	
	\bibitem{PARDISO} Intel MKL PARDISO: https://software.intel.com/content/www/us/en/ develop/documentation/onemkl-developer-reference-c/top.html (Дата обращения 31.03.2021)
	
	\bibitem{Krasnov} Краснов М.М. Метапрограммирование шаблонов C++ в задачах математической физики. М.: ИПМ им. М.В. Келдыша, 2017, 84 с.
	
	\bibitem{SALOME} SALOME: https://www.salome-platform.org/ (Дата обращения 31.03.2021)
	
	\bibitem{Paraview} Paraview: https://www.paraview.org/ (Дата обращения 31.03.2021)
	
	\bibitem{Wolfram} Mangano S. Mathematica Cookbook. --- O'Reilly Media: Sebastopol, 2010. ---  800 p.
\end{thebibliography}

\newpage

\section-{ПРИЛОЖЕНИЕ А}

При решении задач методом конечных элементов возникает потребность в эффективном решении СЛАУ. Прямые методы требуют больших затрат оперативной памяти, поэтому возникает спрос на использование итерационных методов решения. Однако итерационные методы могут иметь слишком медленную сходимость, которая в первую очередь обусловлена самой системой. Таким образом требуется <<смягчить>> получаемую матрицу жёсткости, чтобы увеличить эффективность итерационных методов. Одним из способов <<смягчения>> является выбор альтернативного базиса, для которого скорость сходимости итерационного метода будет наискорейшей.

Для задач в двумерных постановках, в целях экономии вычислительных ресурсов, разумнее всего использовать элементы серендипового семейства. Однако базисы таких элементов, которые предложил Зенкевич \cite{Zienkiewicz}, обладают рядом дефектов, которые повышают жёсткость итоговой системы уравнений. Но были предложены альтернативные базисы \cite{QuadSerendipity}, \cite{QubicSerendipity}, которые лишены данных дефектов. Так, например, для квадратичного серендипового элемента, изображённого на рис. \ref{fig:QuadraticSerendipity}, можно ввести один свободный параметр $s$, благодаря которому базисные функции приобретают вид \cite{QuadSerendipity}
\begin{gather*}
	N_i = \dfrac{1}{16} (1 + \xi_i \xi) (1 + \eta_i \eta) ((9s-1)(1 - \xi_i \xi - \eta_i \eta) + (9s + 3) \xi_i \xi \eta_i \eta),
	\\ \\
	i = 1,3,5,7, \quad \xi_i, \eta_i = \pm 1, 
	\\ \\
	N_i = \dfrac{1}{16} (1 - \xi^2) (1 + \eta_i \eta) ((5 - 9s) + (9s + 3) \eta_i \eta), \quad i = 2,6, \quad \eta_i = \pm 1, 
	\\ \\
	N_i = \dfrac{1}{16} (1 - \eta^2) (1 + \xi_i \xi) ((5 - 9s) + (9s + 3) \xi_i \xi), \quad i = 4,8, \quad \xi_i = \pm 1.
\end{gather*}
Выбор параметра $s$ был основан на следующих предположениях
\begin{gather*}
	\int\limits_1^1 \int\limits_1^1 N_i d \xi d \eta = s, \quad i = 1,3,5,7, 
	\\ \\
	\int\limits_1^1 \int\limits_1^1 N_i d \xi d \eta = 1 - s, \quad i = 2,4,6,8.
\end{gather*}
Таким образом, стандартный базис, который предложил Зенкевич \cite{Zienkiewicz}, будет получен при $s = -1/3$.

\begin{figure}[!h]
	\center{\includegraphics[width=0.5\textwidth]{pics/QuadraticSerendipity.eps}}
	\caption{Нумерация узлов на квадратичном серендиповом элементе}
	\label{fig:QuadraticSerendipity}
\end{figure}

Теперь же проверим зависимость количества итераций метода сопряжённых градиентов от параметра $s$, а также при различных параметрах $p_1$. В качестве тестовой задачи возьмём задачу Неймана на области $S = [0, 5] \times [0, 1]$ с введённой на ней равномерной сеткой $S_h$, состоящей из 18000 квадратичных серендиповых элементов. Поставим следующие граничные условия
\begin{gather*}
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = 0} = -f(\overline{x}_2),
	\quad
	\boldsymbol{\overline{\sigma}} \cdot \boldsymbol{n} |_{\overline{x}_1 = 5} = f(\overline{x}_2),
\end{gather*}
где $f$ определяется следующим образом
\begin{gather*}
	f (x) = 
	\begin{cases}
		4x, & x \leqslant 0.5, \\ \\
		4 - 4x, & x > 0.5.
	\end{cases}
\end{gather*}

\begin{table}[!h]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
	\hline
	Значение      & \multicolumn{4}{c|}{Количество итераций при} \\
	\cline{2-5}
	параметра $s$ & $p_1 = 1$ & $p_1 = 2/3$ & $p_1 = 1/2$ & $p_1 = 1/3$ \\
	\hline
	-1/3          & 2410      & 2014        & 1755        & 1543 \\
	\hline
	-1/4          & 2085      & 1810        & 1577        & 1387 \\
	\hline
	-1/6          & 1938      & 1620        & 1411        & 1241 \\
	\hline
	-1/12         & 1736      & 1451        & 1345        & 1112 \\
	\hline
	0             & 1514      & 1314        & 1217        & 1006 \\
	\hline
	1/12          & 1558      & 1227        & 1136        & 938 \\
	\hline
	1/6           & 1485      & 1240        & 1079        & 948 \\
	\hline
	1/4           & 1591      & 1252        & 1160        & 958 \\
	\hline
	1/3           & 1511      & 1262        & 1170        & 966 \\
	\hline
	5/12          & 1618      & 1274        & 1181        & 974 \\
	\hline
	1/2           & 1560      & 1306        & 1210        & 999 \\
	\hline
	\end{tabular}
	\caption{Количество итераций метода сопряжённых градиентов в классическом и нелокальном случаях при различных параметрах $s$ и $p_1$ при $r = 0.1$}
	\label{Tab:Iterations}
\end{table}

Исходя из результатов, представленных в табл. \ref{Tab:Iterations} и на рис. \ref{fig:Iterations}, видно, что при отрицательных значениях параметра $s$ количество итераций значительно больше, чем при равных по модулю положительных значениях. Однако при достаточно большом увеличении параметра $s$, количество итераций снова начинает увеличиваться и минимум находится в окрестности точки $s = 1/6$. Также отметим, что в нелокальном случае, при уменьшении параметра $p_1$, наблюдается уменьшение количества итераций, но несмотря меньшее количество итераций по сравнению с классическим подходом, время вычислений значительно больше, так как каждая итерация обходится дороже из-за более плотной матрицы жёсткости.

\begin{figure}[!ht]
	\center{\includegraphics[width=0.7\textwidth]{pics/Iterations.eps}}
	\caption{Зависимость количества итераций от параметра $s$ в локальном и нелокальном случаях}
	\label{fig:Iterations}
\end{figure}

Таким образом, использование нестандартных базисов, хоть и не значительно, но всё же способно ускорить скорость решения СЛАУ при использовании итерационных методов. Что касается точности, то практика показала, что для задач рассматриваемых в данной работе, разница между решениями порядка $10^{-5}$, что не очень существенно.

\end{document}
