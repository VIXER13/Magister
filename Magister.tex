\documentclass[14pt,a4paper]{article}

\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[footnotes,oglav,spisok,boldsect,eqwhole,kursrab,remarks,hyperprint]{project_cp}

\usepackage{hhline}
%\usepackage{slashbox}
\usepackage{multirow}
\usepackage{anyfontsize}
\usepackage{t1enc}

\usepackage{extsizes}
\linespread{1.5}
\parindent=1.25cm

\usepackage{geometry}
\geometry{left=3cm, right=1cm, top=2cm, bottom=2cm}

\usepackage{comment}

\begin{document}

\thispagestyle{empty}

\begin{minipage}{0.05\textwidth}
	\hspace{-1.4cm}\vspace{0.5cm}\includegraphics[scale=0.1]{emblema}
\end{minipage}
\hfill
\begin{minipage}{0.95\textwidth}
	\centering
	\linespread{1.0}
	\fontsize{11}{14pt}\selectfont
	\textbf{Министерство образования и науки Российской Федерации \\
	Федеральное государственное бюджетное образовательное учреждение\\высшего профессионального образования\\%
	<<Московский\ государственный\ технический\ университет\\ имени\ Н.\,Э.\,Баумана\\(национальный исследовательский университет)>>\\(МГТУ им. Н.\,Э.\,Баумана)}\\[3mm]
\end{minipage}
\hrule height .7mm

\bigskip

\noindentФАКУЛЬТЕТ <<Фундаментальные науки>> \\
КАФЕДРА <<Прикладная математика>>

\bigskip

\begin{center}
	\begingroup
	\fontsize{20pt}{20pt}\selectfont
	\textbf{РАСЧЁТНО-ПОЯСНИТЕЛЬНАЯ ЗАПИСКА} \\ 
	\fontsize{16pt}{20pt}\selectfont
	\textbf{\textit{К~ВЫПУСКНОЙ~КВАЛИФИКАЦИОННОЙ~РАБОТЕ}}\\ 
	\textbf{\textit{НА ТЕМУ:}}
	
	\medskip
	\fontsize{16pt}{20pt}\selectfont \textbf{\textit{\underline{РАЗРАБОТКА МАТЕМАТИЧЕСКИХ МОДЕЛЕЙ} \underline{НЕЛОКАЛЬНОЙ УПРУГОСТИ И ИХ} \underline{ЧИСЛЕННОЕ РЕШЕНИЕ}}}
	\endgroup
\end{center}

\bigskip

\noindent
\begin{tabular}{lp{6em}cl}
	Студент группы ФН2-42М & & \hspace{3.5cm}                                & А.А. Соколов\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Руководитель ВКР      & & \hspace{3.5cm}                                & Г.Н. Кувыркин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
	Нормоконтролер        & & \hspace{3.5cm}                                & М.М. Лукашин\\ \cline{3-3}
	                      & & \fontsize{8pt}{8pt}\selectfont(Подпись, дата) &\\
\end{tabular}

\vspace*{\fill}

\begin{center}
	2021 г.
\end{center}



\newpage



\section-{АННОТАЦИЯ}




\newpage



\tableofcontents



\newpage



\section-{ВВЕДЕНИЕ}



\section{Основные соотношения}

\subsection{Постановка задачи}

Дано двумерное евклидово пространство $\mathbb{R}^2$ с произвольно выбранной прямоугольной декартовой системой координат $O\text{x}_1 \text{x}_2$, в которой положение точки фиксировано радиус-вектором $\boldsymbol{x} = x_i \boldsymbol{e}_i$, где $\boldsymbol{e}_i$, $i = \overline{1,2}$ --- единичные орты координатных осей; $x_i$, $i = \overline{1,2}$ --- компоненты вектора $\boldsymbol{x}$. В произвольной замкнутой области $S \subset \mathbb{R}^2$ с кусочно-гладкой границей $\partial S$ уравнение равновесия сплошной среды имеет вид \cite{MSS}
\begin{gather}
	\label{EquilibriumEquation}
	\nabla_{\boldsymbol{x}} \cdot \boldsymbol{\hat{\sigma}} + \boldsymbol{b} = \boldsymbol{0},
\end{gather}
где $\nabla_{\boldsymbol{x}} = \partial/\partial x_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- дифференциальный оператор набла; $\boldsymbol{b} = b_i \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- вектор объёмных сил; $\boldsymbol{\hat{\sigma}} = \sigma_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор напряжений, который определяется следующим образом
\begin{gather}
	\label{DefineSigma}
	\boldsymbol{\hat{\sigma}} =
	p_1 \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} +
	p_2 \iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} dS'(\boldsymbol{x}),
\end{gather}
где $\boldsymbol{\hat{\varepsilon}} = \varepsilon_{ij} \boldsymbol{e}_i \otimes \boldsymbol{e}_j$, $i,j = \overline{1, 2}$ --- тензор упругой деформации; $\boldsymbol{\hat{C}} = C_{ijkl} \boldsymbol{e}_i \otimes \boldsymbol{e}_j \otimes \boldsymbol{e}_k \otimes \boldsymbol{e}_l$, $i, j, k, l = \overline{1, 2}$ --- тензор коэффициентов упругости; $p_1 > 0$ и $p_2 \geqslant 0$ --- весовые доли, такие, что $p_1 + p_2 = 1$; $\varphi$ --- функция нелокального влияния, некоторая нормированная положительная функция в области $S'(\boldsymbol{x})$; $S'(\boldsymbol{x})$ --- область нелокального влияния; $\boldsymbol{x'} \in S'(\boldsymbol{x})$

Будем считать, что деформации малы, поэтому для определения компонентов тензора деформации $\boldsymbol{\hat{\varepsilon}}$ воспользуемся соотношением Коши \cite{MSS}
\begin{gather}
	\label{DefineStrains}
	\varepsilon_{ij} = \dfrac{1}{2} \left( 
		\dfrac{\partial u_i}{\partial x_j} +
		\dfrac{\partial u_j}{\partial x_i}
	\right), \quad
	i, j = \overline{1, 2},
\end{gather}
где $u_i$, $i = \overline{1, 2}$ --- компоненты вектора перемещений $\boldsymbol{u}$.

В случае линейно упругого изотропного тела компоненты тензора упругости $\boldsymbol{\hat{C}}$ определяются следующим образом \cite{MSS}
\begin{gather*}
	C_{i, j, k, l} =
	\lambda \delta_{ij} \delta_{kl} +
	\mu (\delta_{ik} \delta_{jl} + \delta_{il} \delta_{jk}), \quad
	i, j, k, l = \overline{1, 2},
\end{gather*}
где $\lambda$ и $\mu$ --- константы Ламе, которые можно определить через коэффициент Пуассона $\nu$ и модуль Юнга $E$ как
\begin{gather*}
	\lambda = \dfrac{\nu E}{(1+\nu)(1-2\nu)}, \quad
	\mu = \dfrac{E}{2(1+\nu)}.
\end{gather*}

Будем рассматривать граничные условия первого и второго родов, также именуемые кинематическими и силовыми соответственно \cite{MSS}
\begin{gather*}
	\boldsymbol{u}|_{\Gamma_1} = \boldsymbol{d}(\boldsymbol{x}), \quad
	\boldsymbol{\hat{\sigma}} \cdot \boldsymbol{n}|_{\Gamma_2} = \boldsymbol{p}(\boldsymbol{x}),
\end{gather*}
где $\Gamma_1, \Gamma_2 \subset \partial S$; $\Gamma_1 \cup \Gamma_2 = \emptyset$; $\boldsymbol{d}(\boldsymbol{x}) = d_i(\boldsymbol{x}) \boldsymbol{e}_i$ и $\boldsymbol{p}(\boldsymbol{x}) = p_i(\boldsymbol{x}) \boldsymbol{e}_i$, $i = \overline{1, 2}$ --- некоторые функции, задающие перемещение и давление на границах соответственно.

\subsection{Выбор функций нелокального влияния}

\vspace{2em}

В определении тензора напряжений (\ref{DefineSigma}) не конкретизируется геометрия области нелокального влияния $S'(\boldsymbol{x})$ и вид функции нелокального влияния $\varphi$. Чаще всего в расчётах используют функцию нормального распределения Гаусса, а зону нелокального влияния аппроксимируют по првилу трёх сигм, но полученные при такой аппроксимации зоны получаются весьма большими, что накладывает серьёзные требования на объёмы используемой оперативной памяти. Вместе с тем, вычисление экспонент является весьма затратным с вычислительной точки зрения, поэтому предлагается использовать весьма широкий класс полиномиальных функций нелокального влияния с фиксированными областями нелокального влияния $S'(\boldsymbol{x})$, которые можно представить в виде
\begin{gather}
	\label{phi}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') =
	\begin{cases}
		A (1 - \rho(\boldsymbol{x}, \boldsymbol{x}')^p )^q, & \rho(\boldsymbol{x}, \boldsymbol{x}') \leqslant 1, \\
		0, & \rho(\boldsymbol{x}, \boldsymbol{x}') > 1,
	\end{cases}
\end{gather}
где $\rho$ --- метрическая функция, которую в общем случае можно определить следующим образом
\begin{gather*}
	\rho(\boldsymbol{x}, \boldsymbol{x}') = \sqrt[n]{
		\left| \dfrac{x_1 - x_1'}{r_1} \right|^n	+
		\left| \dfrac{x_2 - x_2'}{r_2} \right|^n
	}.
\end{gather*}
Тогда нормировочный множитель $A$ примет значение
\begin{gather*}
	A = \dfrac{pn}{4 r_1 r_2 \text{B}(1/n, 1/n) \text{B}(2/p, q+1)},
\end{gather*}
где $r_1, r_2 > 0$ --- радиусы нелокального влияния вдоль каждой оси; $n > 0$ --- параметр лебегова пространства; $p, q > 0$ --- параметры плотности распределения нелокального влияния; B --- бета-функция Эйлера.

Предполагается, что изучаемые тела изотропны, поэтому будем считать, что область нелокального влияния представляет из себя круг, то есть $r_1 = r_2 = r$, а параметр $n = 2$. Что касается параметров плотности распределения влияния, то стоит отметить, что при увеличении параметра $p$ распределение влияния становится более равномерным и стремится к константе, что в теории должно приводить к увеличению отклонения от классического закона. При увеличении параметра $q$ распределение влияния концентрируется в центре области и стремится к дельта-функции Дирака, которая даст нам классический закон Гука. На рис. 1 и 2 представлены примеры функций влияния в разрезе по оси симметрии при различных параметрах $p$ и $q$. Для наглядности введём обозначение $\varphi_{p,q}$, которое даст понять какие параметры были выбраны.

\begin{center}
	\includegraphics[width=0.6\textwidth]{pics/PhiVariableP.eps} \\
	Рис. 1 Портреты функций влияния при вариации $p$
\end{center}

\begin{center}
	\includegraphics[width=0.6\textwidth]{pics/PhiVariableQ.eps} \\
	Рис. 2 Портреты функций влияния при вариации $q$
\end{center}

\subsection{Построение численной схемы решения на основе метода конечных элементов}

В качестве численного метода решения уравнения (\ref{EquilibriumEquation}) выберем метод конечных элементов с использованием изопараметрических конечных элементов \cite{Zienkiewicz}, \cite{Bathe}. Для этого на области $S$ введём сетку конечно-элементной модели $S_h$, которая включает в себя множества номеров узлов и элементов. Каждый элемент $(e) \in S_h$ содержит в себе наборы узлов $\left\{\boldsymbol{x}_i^{(e)}\right\}_{i \in I^{(e)}}$ и базисных функций $\left\{N_i^{(e)}\right\}_{i \in I^{(e)}}$ таких, что $N_i^{(e)}\left(\boldsymbol{x}_j^{(e)}\right) = \delta_{ij}$ и $\sum\limits_{i \in I^{(e)}} N_i^{(e)}(\boldsymbol{x}) = 1$, $\forall \boldsymbol{x} \in S^{(e)}$, где $I^{(e)}$ --- набор индексов узлов элемента $(e)$, $\delta_{ij}$ --- дельта-функция Кронекера, $S^{(e)}$ --- область элемента $(e)$. Для каждого элемента $(e)$ введём локальную систему координат $O\xi_1^{(e)}\xi_2^{(e)}$. Отображение из локальной системы координат $O\xi_1^{(e)}\xi_2^{(e)}$ в глобальную $O\text{x}_1\text{x}_2$ будем строить следующим образом
\begin{gather*}
	\boldsymbol{x}\left( \boldsymbol{\xi}^{(e)} \right) =
	N_i^{(e)} \left( \boldsymbol{\xi}^{(e)} \right) \boldsymbol{x}_i^{(e)}, \quad
	i \in I^{(e)}, \ (e) \in S_h,
\end{gather*}
где $\boldsymbol{x}_i^{(e)}$ --- значение глобальных координат в узлах элемента $(e)$. Тогда матрицу Якоби перехода из локальной системы координат в глобальную аппроксимируем следующим образом
\begin{gather*}
	\boldsymbol{\hat{J}}^{(e)} = 
	\left( \dfrac{\partial \boldsymbol{\xi}^{(e)}}{\partial \boldsymbol{x}} \right) =
	\left( \dfrac{\partial \boldsymbol{x}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1} \approx
	\left( \boldsymbol{x}_i^{(e)} \dfrac{\partial N_i^{(e)}}{\partial \boldsymbol{\xi}^{(e)}} \right)^{-1}, \quad
	i \in I^{(e)}, \ (e) \in S_h.
\end{gather*}

Домножим уравнение (\ref{EquilibriumEquation}) на функцию формы $N_n^{(e)}$ и проинтегрируем по области $S$
\begin{gather*}
	\iint\limits_S N_n^{(e)} (\nabla_{\boldsymbol{x}} \cdot \boldsymbol{\hat{\sigma}} + \boldsymbol{b}) dS = \boldsymbol{0}, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
Проинтегрируем первое слагаемое по частям, тогда по формуле Грина получим
\begin{gather*}
	\iint\limits_S (\nabla_{\boldsymbol{x}} N_n^{(e)}) \cdot \boldsymbol{\hat{\sigma}} dS -
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma +
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS = \boldsymbol{0}, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{gather*}
На место $\boldsymbol{\hat{\sigma}}$ подставим соотношение (\ref{DefineSigma})
\begin{multline*}
	p_1 \iint\limits_S 
	\left( \nabla_{\boldsymbol{x}} N_n^{(e)} \right)
	\cdot
	\left( \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}} \right) dS
	+
	p_2 \iint\limits_S
	\left( \nabla_{\boldsymbol{x}} N_n^{(e)} \right)
	\cdot
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') \boldsymbol{\hat{C}} \cdot \cdot \boldsymbol{\hat{\varepsilon}}
	dS'(\boldsymbol{x})
	dS 
	- \\ -
	\oint\limits_{\Gamma_2} N_n^{(e)} \boldsymbol{p} d\Gamma
	+
	\iint\limits_S N_n^{(e)} \boldsymbol{b} dS = \boldsymbol{0}, \quad
	n \in I^{(e)}, \ (e) \in S_h.
\end{multline*}
Перейдём к индексной форме записи
\begin{multline*}
	p_1 \iint\limits_S \dfrac{\partial N_n^{(e)}}{\partial x_i} C_{ijkl} \varepsilon_{kl} dS
	+
	p_2 \iint\limits_S
	\dfrac{\partial N_n^{(e)}}{\partial x_i}
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') C_{ijkl} \varepsilon_{kl}
	dS'(\boldsymbol{x})
	dS 
	- \\ -
	\oint\limits_{\Gamma_2} N_n^{(e)} p_i d\Gamma
	+
	\iint\limits_S N_n^{(e)} b_i dS = 0, \quad
	i, j, k, l = \overline{1, 2}, \ n \in I^{(e)}, \ (e) \in S_h.
\end{multline*}
Воспользуемся соотношением Коши (\ref{DefineStrains}) и заменим перемещения $\boldsymbol{u}$ интерполяционными соотношениями, то есть представим в виде $\boldsymbol{u}(\boldsymbol{x}) \approx \boldsymbol{u}_i^{(e)} N_i^{(e)}(\boldsymbol{x})$, $i \in I^{(e)}$, где $\boldsymbol{u}_i^{(e)}$ -- искомые перемещения в узлах элемента $(e)$. Тогда уравнение принимает вид
\begin{multline*}
	\dfrac{p_1}{2} \iint\limits_S 
	\dfrac{\partial N_n^{(e)}}{\partial x_i} C_{ijkl} 
	\left( 
	u_{lm}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_k} +
	u_{km}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_l} 
	\right)
	dS
	-
	\oint\limits_{\Gamma_2} N_n^{(e)} p_i d\Gamma
	+
	\iint\limits_S N_n^{(e)} b_i dS
	+ \\ +
	\dfrac{p_2}{2} \iint\limits_S
	\dfrac{\partial N_n^{(e)}}{\partial x_i}
	\iint\limits_{S'(\boldsymbol{x}) \cap S}
	\varphi(\boldsymbol{x}, \boldsymbol{x}') C_{ijkl} 
	\left(
	u_{lm'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_k'} +
	u_{km'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_l'}
	\right)
	dS'(\boldsymbol{x})
	dS = 0,
	\\
	i, j, k, l = \overline{1, 2}, \ n,m \in I^{(e)}, \ m' \in I^{(e')}, \ (e) \in S_h, (e') \in S_h', S_h' \subset S_h,
\end{multline*}
где $S_h'$ --- аппроксимированная зона нелокального влияния. Зону нелокального влияния аппроксимируем относительно каждого квадратурного узла и будем считать, что те элементы, квадратурные узлы которых хотя бы частично попали в эту область будут участвовать в расчёте. Таким образом, аппроксимируем интегралы конечными суммами и наконец приходим к конечному равенству, где происходит ассамблирование матрицы жёсткости и правой части
\begin{multline}
	\label{StiffnessMatrix}
	\dfrac{p_1}{2} 
	\sum\limits_{(e) \in S_h} \sum\limits_{n,m \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} ( \boldsymbol{x}_q ) C_{ijkl}
	\left( 
	u_{lm}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_k} ( \boldsymbol{x}_q ) +
	u_{km}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_l} ( \boldsymbol{x}_q ) 
	\right) J_q^{(e)}
	+ \\ +
	\dfrac{p_2}{2} 
	\sum\limits_{(e) \in S_h} \sum\limits_{n \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} (\boldsymbol{x}_q) J_q^{(e)}
	\sum\limits_{(e') \in S_h'^{(q)}} \sum\limits_{m' \in I^{(e')}} \sum\limits_{q' \in Q^{(e')}}
	w_{q'} 
	\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}') C_{ijkl}
	\times \\ \times
	\left( 
	u_{lm'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_k'} ( \boldsymbol{x}_{q'}' ) +
	u_{km'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_l'} ( \boldsymbol{x}_{q'}' ) 
	\right) J_{q'}^{(e)}
	= \\ =
	\sum\limits_{(be) \in \Gamma_h} \sum\limits_{n \in I^{(be)}} \sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)} p_i (\boldsymbol{x}_q) J_q^{(be)}
	-
	\sum\limits_{(e) \in S_h} \sum\limits_{n \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q N_n^{(e)} b_i (\boldsymbol{x}_q) J_q^{(e)}
	, \\
	i, j, k, l = \overline{1, 2},
\end{multline}
где $Q^{(e)}$ --- набор индексов квадратурных узлов элемента $(e)$; $S_h'^{(q)}$ --- аппроксимированная зона нелокального влияния на квадратурном узле $q$; $\Gamma_h$ --- конечно-элементная модель границы области $S$; $(be)$ --- одномерные элементы заданные на границе; $w_q$ --- квадратурные веса; $J_q^{(e)} = \left|\det{\boldsymbol{\hat{J}}^{(e)}(\boldsymbol{x}_q)}\right|$ --- якобиан вычисленный в квадратурной точке $\boldsymbol{x}_q$.

Вычисление системы (\ref{StiffnessMatrix}) можно упростить записав производные от функций форм в локальной системе координат элементов
\begin{gather*}
	\dfrac{\partial N_i^{(e)}}{\partial x_k} =
	\dfrac{\partial N_i^{(e)}}{\partial \xi_j^{(e)}}
	\dfrac{\partial \xi_j^{(e)}}{\partial x_k}, \quad
	j, k = \overline{1, 2}, \ i \in I^{(e)}, \ (e) \in S_h.
\end{gather*}

Якобиан на границе аппроксимируем следующим образом
\begin{gather*}
	J^{(be)} = \sqrt{
	\left( x_{1i}^{(e)} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2 +
	\left( x_{2i}^{(e)} \dfrac{\partial N_i^{(e)}}{\partial \xi^{(e)}} \right)^2	
	}, \quad
	i \in I^{(e)}, \ (e) \in \Gamma_h.
\end{gather*}
Заметим, что индекс оси $\xi^{(e)}$ не ставится, так как элемент одномерный.




\section{Программная реализация}

\subsection{Аппроксимация зоны нелокального влияния}

Основной проблемой, которая возникает при решении данной задачи, является аппроксимация интегрального слагаемого в (\ref{DefineSigma}), так как в матрицах элементов необходимо учитывать влияние, которое приходится на соседние элементы. Действуя по правилам аппроксимации вложенных интегралов мы приходим к тому, что в уравнении (\ref{StiffnessMatrix}) порядок сумм заставляет нас аппроксимировать зону нелокального влияния для каждого квадратурного узла сетки, что не очень практично, так как выполнять поиск ближайших соседей относительно квадратурных узлов может быть весьма затратной процедурой, а хранении индексов элементов, которые попадают в зону влияния, очень дорогим. Более того, такой подход попросту сложно реализовать программно, поэтому предлагается аппроксимировать зону нелокального влияния относительно центров элементов и учитывать в расчётах те элементы, центры которых попали в зону влияния. Тогда формулу (\ref{StiffnessMatrix}) можно переписать в следующем виде
\begin{multline}
	\label{StiffnessMatrixElementsApprox}
	\dfrac{p_1}{2} 
	\sum\limits_{(e) \in S_h} \sum\limits_{n,m \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} ( \boldsymbol{x}_q ) C_{ijkl}
	\left( 
	u_{lm}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_k} ( \boldsymbol{x}_q ) +
	u_{km}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_l} ( \boldsymbol{x}_q ) 
	\right) J_q^{(e)}
	+ \\ +
	\dfrac{p_2}{2} 
	\sum\limits_{(e) \in S_h} \sum\limits_{(e') \in S_h'^{(e)}}
	\sum\limits_{n \in I^{(e)}} \sum\limits_{m' \in I^{(e')}} 
	\sum\limits_{q \in Q^{(e)}} 
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} ( \boldsymbol{x}_q ) J_q^{(e)}
	\times \\ \times
	\sum\limits_{q' \in Q^{(e')}}
	w_{q'} 
	\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}') C_{ijkl}
	\left( 
	u_{lm'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_k'} ( \boldsymbol{x}_{q'}' ) +
	u_{km'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_l'} ( \boldsymbol{x}_{q'}' ) 
	\right) J_{q'}^{(e)}
	= \\ =
	\sum\limits_{(be) \in \Gamma_h} \sum\limits_{n \in I^{(be)}} \sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)} p_i (\boldsymbol{x}_q) J_q^{(e)}
	-
	\sum\limits_{(e) \in S_h} \sum\limits_{n \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q N_n^{(e)} b_i (\boldsymbol{x}_q) J_q^{(e)}
	, \\
	i, j, k, l = \overline{1, 2},
\end{multline}
где $S_h'^{(e)}$ --- зона нелокального влияния аппроксимированная на элементе.

Заметим, что в формуле (\ref{StiffnessMatrixElementsApprox}) поменялся порядок знаков суммирования, а значит и порядок действий. С точки зрения написания вычислительной программы это означает лишь перестановку циклов и введение дополнительных массивов индексов. Для успешного интегрирования, зону аппроксимации лучше всего брать несколько больше, нежели реальная зона нелокального влияния, таким образом возникает шанс того, что все квадратурные узлы, которые попали под зону влияния $S'(\boldsymbol{x})$ будут учтены в расчёте. Естественно, радиус поиска следует определять исходя из грубости сетки, что наглядно продемонстрировано на рис. 3.

\begin{center}
	\includegraphics[width=0.6\textwidth]{pics/ApproxS.eps} \\
	Рис. 3 Аппроксимация зоны нелокального влияния
\end{center}

\subsection{Распараллеливание алгоритма}

Учитывая высокую вычислительную сложность подобных задач разумно использовать возможности современных вычислительных систем, а именно параллельные и распределённые вычисления. К сожалению, обход сетки, который задаётся порядком суммирования в (\ref{StiffnessMatrixElementsApprox}) не позволяет эффективно использовать такие возможности, поэтому предлагается определить другой порядок обхода сетки, в котором не будет проблем связанных с гонкой данных и который позволит собирать части матрицы независимо сразу в нескольких процессах. Этого можно достичь определив для каждого узла сетки множество элементов $E^{(n)}$, которым он принадлежит. Таким образом, формула (\ref{StiffnessMatrixElementsApprox}) принимает вид
\begin{multline*}
	\dfrac{p_1}{2} 
	\sum\limits_{n \in S_h} \sum\limits_{(e) \in E^{(n)}} \sum\limits_{m \in I^{(e)}} \sum\limits_{q \in Q^{(e)}}
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} ( \boldsymbol{x}_q ) C_{ijkl}
	\times \\ \times
	\left( 
	u_{lm}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_k} ( \boldsymbol{x}_q ) +
	u_{km}^{(e)} \dfrac{\partial N_m^{(e)}}{\partial x_l} ( \boldsymbol{x}_q ) 
	\right) J_q^{(e)}
	+ \\ +
	\dfrac{p_2}{2} 
	\sum\limits_{n \in S_h} \sum\limits_{(e) \in E^{(n)}} \sum\limits_{(e') \in S_h'^{(e)}}
	\sum\limits_{m' \in I^{(e')}} \sum\limits_{q \in Q^{(e)}} 
	w_q \dfrac{\partial N_n^{(e)}}{\partial x_i} ( \boldsymbol{x}_q ) J_q^{(e)}
	\times \\ \times
	\sum\limits_{q' \in Q^{(e')}}
	w_{q'} 
	\varphi(\boldsymbol{x}_q, \boldsymbol{x}_{q'}') C_{ijkl}
	\left( 
	u_{lm'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_k'} ( \boldsymbol{x}_{q'}' ) +
	u_{km'}^{(e')} \dfrac{\partial N_{m'}^{(e')}}{\partial x_l'} ( \boldsymbol{x}_{q'}' ) 
	\right) J_{q'}^{(e)}
	= \\ =
	\sum\limits_{(be) \in \Gamma_h} \sum\limits_{n \in I^{(be)}} \sum\limits_{q \in Q^{(be)}}
	w_q N_n^{(be)} p_i (\boldsymbol{x}_q) J_q^{(be)}
	-
	\sum\limits_{n \in S_h} \sum\limits_{(e) \in E^{(n)}} \sum\limits_{q \in Q^{(e)}}
	w_q N_n^{(e)} b_i (\boldsymbol{x}_q) J_q^{(e)}, \\
	i, j, k, l = \overline{1, 2}.
\end{multline*}
Такой подход позволяет эффективно использовать возможности параллельных и распределённых систем, так как каждая строка матрицы вычисляется независимо от всех остальных.

\subsection{Балансировка данных}

При распределённых вычислениях возникает проблема связанная с балансировкой данных по процессам. При равномерном разбиении узлов по процессам, данные могут распределиться не равномерно, так как у некоторых узлов могут быть элементы с преобладающим количеством ближайших соседей, что плохо сказывается на эффективности такого рода вычислениях. Помимо того, что один из процессов может производить вычисления заметно дольше, чем все остальные, он так же может потреблять слишком много оперативной памяти, что может привести к тому, что задача, которая потенциально могла быть решена на той или иной вычислительной системе, вдруг перестаёт быть таковой, так как на одном из узлов кластера не хватает оперативной памяти. В таком случае разумно сделать балансировку данных по процессам.

Идеальная балансировка подразумевает под собой баланс потребляемых объёмов оперативной памяти и объёмов вычислений между всеми процессами, но практика показывает, что добиться такой балансировки в общем случае не удаётся, поэтому опишем два возможных варианта балансировки.

Первый вариант балансировки подразумевает под собой балансировку потребляемых объёмов оперативной памяти. Это достигается осреднением числа ближайших соседей между процессами, то есть для каждого из процессов определяется набор элементов, которые участвуют в расчёте. Затем для каждого из наборов вычисляется общее число соседей, далее эти числа суммируются и осредняются на число процессов. После этого узлы распределяются таким образом, чтобы общее число соседей было близко к среднему по процессам. При такой балансировке каждый из процессов будет владеть частями матрицы, которые близки по объёму.

Второй вариант балансировки подразумевает под собой балансировку объёмов вычислений. Такой вариант балансировки достигается аналогичными методами, как и балансировка памяти, но в качестве осредняемого параметра выбирается количество вызовов функции интегрирования.





\newpage



\begin{thebibliography}{1}
	\bibitem{MSS} Зарубин В.С., Кувыркин Г.Н. Математические модели механики и электродинамики сплошной среды. М.: Изд-во МГТУ им. Н.Э. Баумана, 2008. 512 с.
	
	\bibitem{Zienkiewicz} Zienkiewicz O. The Finite Element Method: Its Basis and Fundamentals. Seventh edition. / O. Zienkiewicz, R. Taylor, J.Z. Zhu -- 2013. -- 756 p.

	\bibitem{Bathe} Bathe K-J. Finite Element Procedures. Second edition. --- 2014. --- 1065 p.
\end{thebibliography}

\end{document}